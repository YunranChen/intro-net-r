<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>4 Collect network data and API requests | Introduction to Network Analysis Using R</title>
  <meta name="description" content="This github page provide a basic introduction on network analysis using R. The documents are based on the lab materials of STAT650 Social Network at Duke University.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="4 Collect network data and API requests | Introduction to Network Analysis Using R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This github page provide a basic introduction on network analysis using R. The documents are based on the lab materials of STAT650 Social Network at Duke University." />
  <meta name="github-repo" content="YunranChen/intro-network-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Collect network data and API requests | Introduction to Network Analysis Using R" />
  
  <meta name="twitter:description" content="This github page provide a basic introduction on network analysis using R. The documents are based on the lab materials of STAT650 Social Network at Duke University." />
  

<meta name="author" content="Yunran Chen">


<meta name="date" content="2019-04-27">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="ergm-statnet-package.html">
<link rel="next" href="advanced-network-visualization.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.8.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.39.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.39.2/plotly-latest.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#outline"><i class="fa fa-check"></i><b>1.1</b> Outline</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#detailed-outline"><i class="fa fa-check"></i><b>1.2</b> Detailed Outline</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="igraph.html"><a href="igraph.html"><i class="fa fa-check"></i><b>2</b> <code>igraph</code> package</a><ul>
<li class="chapter" data-level="2.1" data-path="igraph.html"><a href="igraph.html#introduction-1"><i class="fa fa-check"></i><b>2.1</b> Introduction</a><ul>
<li class="chapter" data-level="2.1.1" data-path="igraph.html"><a href="igraph.html#igraph-vs-statnet"><i class="fa fa-check"></i><b>2.1.1</b> <code>igraph</code> vs <code>statnet</code></a></li>
<li class="chapter" data-level="2.1.2" data-path="igraph.html"><a href="igraph.html#references"><i class="fa fa-check"></i><b>2.1.2</b> References</a></li>
<li class="chapter" data-level="2.1.3" data-path="igraph.html"><a href="igraph.html#preparation"><i class="fa fa-check"></i><b>2.1.3</b> Preparation</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="igraph.html"><a href="igraph.html#create-networks-and-basics-concepts"><i class="fa fa-check"></i><b>2.2</b> Create networks and basics concepts</a><ul>
<li class="chapter" data-level="2.2.1" data-path="igraph.html"><a href="igraph.html#outline-1"><i class="fa fa-check"></i><b>2.2.1</b> Outline</a></li>
<li class="chapter" data-level="2.2.2" data-path="igraph.html"><a href="igraph.html#create-simple-networks"><i class="fa fa-check"></i><b>2.2.2</b> Create simple networks</a></li>
<li class="chapter" data-level="2.2.3" data-path="igraph.html"><a href="igraph.html#creating-specific-graphs-and-graph-models"><i class="fa fa-check"></i><b>2.2.3</b> Creating specific graphs and graph models</a></li>
<li class="chapter" data-level="2.2.4" data-path="igraph.html"><a href="igraph.html#adjustments-on-graphs"><i class="fa fa-check"></i><b>2.2.4</b> Adjustments on graphs</a></li>
<li class="chapter" data-level="2.2.5" data-path="igraph.html"><a href="igraph.html#edge-vertex-and-network-attributes"><i class="fa fa-check"></i><b>2.2.5</b> Edge, vertex and network attributes</a></li>
<li class="chapter" data-level="2.2.6" data-path="igraph.html"><a href="igraph.html#description-of-igraph-object"><i class="fa fa-check"></i><b>2.2.6</b> Description of igraph object</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="igraph.html"><a href="igraph.html#built-networks-from-external-sources-basic-visualization-and-more-on-network-descriptions"><i class="fa fa-check"></i><b>2.3</b> Built networks from external sources, basic visualization and more on network descriptions</a><ul>
<li class="chapter" data-level="2.3.1" data-path="igraph.html"><a href="igraph.html#outline-2"><i class="fa fa-check"></i><b>2.3.1</b> Outline</a></li>
<li class="chapter" data-level="2.3.2" data-path="igraph.html"><a href="igraph.html#dataset"><i class="fa fa-check"></i><b>2.3.2</b> Dataset</a></li>
<li class="chapter" data-level="2.3.3" data-path="igraph.html"><a href="igraph.html#get-network-from-files"><i class="fa fa-check"></i><b>2.3.3</b> Get network from files</a></li>
<li class="chapter" data-level="2.3.4" data-path="igraph.html"><a href="igraph.html#visualization"><i class="fa fa-check"></i><b>2.3.4</b> Visualization</a></li>
<li class="chapter" data-level="2.3.5" data-path="igraph.html"><a href="igraph.html#network-and-node-descriptions"><i class="fa fa-check"></i><b>2.3.5</b> Network and node descriptions</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="igraph.html"><a href="igraph.html#paths-communitites-and-related-visualization"><i class="fa fa-check"></i><b>2.4</b> Paths, communitites and related visualization</a><ul>
<li class="chapter" data-level="2.4.1" data-path="igraph.html"><a href="igraph.html#outline-3"><i class="fa fa-check"></i><b>2.4.1</b> Outline</a></li>
<li class="chapter" data-level="2.4.2" data-path="igraph.html"><a href="igraph.html#datasets"><i class="fa fa-check"></i><b>2.4.2</b> Datasets</a></li>
<li class="chapter" data-level="2.4.3" data-path="igraph.html"><a href="igraph.html#paths-distances-and-diameter"><i class="fa fa-check"></i><b>2.4.3</b> Paths, distances and diameter</a></li>
<li class="chapter" data-level="2.4.4" data-path="igraph.html"><a href="igraph.html#components"><i class="fa fa-check"></i><b>2.4.4</b> Components</a></li>
<li class="chapter" data-level="2.4.5" data-path="igraph.html"><a href="igraph.html#community"><i class="fa fa-check"></i><b>2.4.5</b> Community</a></li>
<li class="chapter" data-level="2.4.6" data-path="igraph.html"><a href="igraph.html#visualization-1"><i class="fa fa-check"></i><b>2.4.6</b> Visualization</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="igraph.html"><a href="igraph.html#more-about-igraph"><i class="fa fa-check"></i><b>2.5</b> More about <code>igraph</code></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ergm-statnet-package.html"><a href="ergm-statnet-package.html"><i class="fa fa-check"></i><b>3</b> ERGM (<code>statnet</code> Package)</a><ul>
<li class="chapter" data-level="3.1" data-path="ergm-statnet-package.html"><a href="ergm-statnet-package.html#introduction-2"><i class="fa fa-check"></i><b>3.1</b> Introduction</a><ul>
<li class="chapter" data-level="3.1.1" data-path="ergm-statnet-package.html"><a href="ergm-statnet-package.html#outline-4"><i class="fa fa-check"></i><b>3.1.1</b> Outline</a></li>
<li class="chapter" data-level="3.1.2" data-path="ergm-statnet-package.html"><a href="ergm-statnet-package.html#statnet"><i class="fa fa-check"></i><b>3.1.2</b> <code>statnet</code></a></li>
<li class="chapter" data-level="3.1.3" data-path="ergm-statnet-package.html"><a href="ergm-statnet-package.html#references-1"><i class="fa fa-check"></i><b>3.1.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="ergm-statnet-package.html"><a href="ergm-statnet-package.html#preparation-1"><i class="fa fa-check"></i><b>3.2</b> Preparation</a></li>
<li class="chapter" data-level="3.3" data-path="ergm-statnet-package.html"><a href="ergm-statnet-package.html#summary-the-network-statistics"><i class="fa fa-check"></i><b>3.3</b> <code>summary</code> the network statistics</a><ul>
<li class="chapter" data-level="3.3.1" data-path="ergm-statnet-package.html"><a href="ergm-statnet-package.html#dataset-1"><i class="fa fa-check"></i><b>3.3.1</b> Dataset</a></li>
<li class="chapter" data-level="3.3.2" data-path="ergm-statnet-package.html"><a href="ergm-statnet-package.html#summary"><i class="fa fa-check"></i><b>3.3.2</b> <code>summary</code></a></li>
<li class="chapter" data-level="3.3.3" data-path="ergm-statnet-package.html"><a href="ergm-statnet-package.html#directed-networks"><i class="fa fa-check"></i><b>3.3.3</b> directed networks</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="ergm-statnet-package.html"><a href="ergm-statnet-package.html#ergm-fit-ergm-model"><i class="fa fa-check"></i><b>3.4</b> <code>ergm</code> fit ergm model</a><ul>
<li class="chapter" data-level="3.4.1" data-path="ergm-statnet-package.html"><a href="ergm-statnet-package.html#ergm"><i class="fa fa-check"></i><b>3.4.1</b> ERGM</a></li>
<li class="chapter" data-level="3.4.2" data-path="ergm-statnet-package.html"><a href="ergm-statnet-package.html#ergm-function."><i class="fa fa-check"></i><b>3.4.2</b> <code>ergm</code> function.</a></li>
<li class="chapter" data-level="3.4.3" data-path="ergm-statnet-package.html"><a href="ergm-statnet-package.html#ergm-terms"><i class="fa fa-check"></i><b>3.4.3</b> <code>ergm-terms</code></a></li>
<li class="chapter" data-level="3.4.4" data-path="ergm-statnet-package.html"><a href="ergm-statnet-package.html#missing-edges"><i class="fa fa-check"></i><b>3.4.4</b> Missing edges</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="ergm-statnet-package.html"><a href="ergm-statnet-package.html#simulate-netowrks-from-an-ergm-model-fit"><i class="fa fa-check"></i><b>3.5</b> <code>simulate</code> netowrks from an ergm model fit</a></li>
<li class="chapter" data-level="3.6" data-path="ergm-statnet-package.html"><a href="ergm-statnet-package.html#check-the-goodness-of-fit"><i class="fa fa-check"></i><b>3.6</b> Check the goodness of fit</a><ul>
<li class="chapter" data-level="3.6.1" data-path="ergm-statnet-package.html"><a href="ergm-statnet-package.html#gof"><i class="fa fa-check"></i><b>3.6.1</b> <code>gof</code></a></li>
<li class="chapter" data-level="3.6.2" data-path="ergm-statnet-package.html"><a href="ergm-statnet-package.html#mcmc.diagnostics"><i class="fa fa-check"></i><b>3.6.2</b> <code>mcmc.diagnostics</code></a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="ergm-statnet-package.html"><a href="ergm-statnet-package.html#more-functions"><i class="fa fa-check"></i><b>3.7</b> More functions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="collect-network-data-and-api-requests.html"><a href="collect-network-data-and-api-requests.html"><i class="fa fa-check"></i><b>4</b> Collect network data and API requests</a><ul>
<li class="chapter" data-level="4.1" data-path="collect-network-data-and-api-requests.html"><a href="collect-network-data-and-api-requests.html#several-useful-websites"><i class="fa fa-check"></i><b>4.1</b> Several useful websites</a></li>
<li class="chapter" data-level="4.2" data-path="collect-network-data-and-api-requests.html"><a href="collect-network-data-and-api-requests.html#web-scraping"><i class="fa fa-check"></i><b>4.2</b> Web scraping</a></li>
<li class="chapter" data-level="4.3" data-path="collect-network-data-and-api-requests.html"><a href="collect-network-data-and-api-requests.html#preparation-2"><i class="fa fa-check"></i><b>4.3</b> Preparation</a></li>
<li class="chapter" data-level="4.4" data-path="collect-network-data-and-api-requests.html"><a href="collect-network-data-and-api-requests.html#twitter-api-request"><i class="fa fa-check"></i><b>4.4</b> Twitter API request</a><ul>
<li class="chapter" data-level="4.4.1" data-path="collect-network-data-and-api-requests.html"><a href="collect-network-data-and-api-requests.html#r-package-rtweet"><i class="fa fa-check"></i><b>4.4.1</b> R package <code>rtweet</code></a></li>
<li class="chapter" data-level="4.4.2" data-path="collect-network-data-and-api-requests.html"><a href="collect-network-data-and-api-requests.html#preparation-3"><i class="fa fa-check"></i><b>4.4.2</b> Preparation</a></li>
<li class="chapter" data-level="4.4.3" data-path="collect-network-data-and-api-requests.html"><a href="collect-network-data-and-api-requests.html#api-authorization"><i class="fa fa-check"></i><b>4.4.3</b> API authorization</a></li>
<li class="chapter" data-level="4.4.4" data-path="collect-network-data-and-api-requests.html"><a href="collect-network-data-and-api-requests.html#rtweet"><i class="fa fa-check"></i><b>4.4.4</b> <code>rtweet</code></a></li>
<li class="chapter" data-level="4.4.5" data-path="collect-network-data-and-api-requests.html"><a href="collect-network-data-and-api-requests.html#retweet-networks"><i class="fa fa-check"></i><b>4.4.5</b> Retweet networks</a></li>
<li class="chapter" data-level="4.4.6" data-path="collect-network-data-and-api-requests.html"><a href="collect-network-data-and-api-requests.html#friendship-networks"><i class="fa fa-check"></i><b>4.4.6</b> Friendship networks</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="collect-network-data-and-api-requests.html"><a href="collect-network-data-and-api-requests.html#other-apis"><i class="fa fa-check"></i><b>4.5</b> Other APIs</a></li>
<li class="chapter" data-level="4.6" data-path="collect-network-data-and-api-requests.html"><a href="collect-network-data-and-api-requests.html#api-request-directly-from-r"><i class="fa fa-check"></i><b>4.6</b> API request directly from R</a><ul>
<li class="chapter" data-level="4.6.1" data-path="collect-network-data-and-api-requests.html"><a href="collect-network-data-and-api-requests.html#introduction-3"><i class="fa fa-check"></i><b>4.6.1</b> Introduction</a></li>
<li class="chapter" data-level="4.6.2" data-path="collect-network-data-and-api-requests.html"><a href="collect-network-data-and-api-requests.html#preparation-4"><i class="fa fa-check"></i><b>4.6.2</b> preparation</a></li>
<li class="chapter" data-level="4.6.3" data-path="collect-network-data-and-api-requests.html"><a href="collect-network-data-and-api-requests.html#search-people-id"><i class="fa fa-check"></i><b>4.6.3</b> search people id</a></li>
<li class="chapter" data-level="4.6.4" data-path="collect-network-data-and-api-requests.html"><a href="collect-network-data-and-api-requests.html#search-movies-based-on-people-id"><i class="fa fa-check"></i><b>4.6.4</b> search movies based on people id</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="advanced-network-visualization.html"><a href="advanced-network-visualization.html"><i class="fa fa-check"></i><b>5</b> Advanced Network Visualization</a><ul>
<li class="chapter" data-level="5.1" data-path="advanced-network-visualization.html"><a href="advanced-network-visualization.html#introduction-4"><i class="fa fa-check"></i><b>5.1</b> Introduction</a><ul>
<li class="chapter" data-level="5.1.1" data-path="advanced-network-visualization.html"><a href="advanced-network-visualization.html#outline-5"><i class="fa fa-check"></i><b>5.1.1</b> Outline</a></li>
<li class="chapter" data-level="5.1.2" data-path="advanced-network-visualization.html"><a href="advanced-network-visualization.html#available-r-packages-and-tutorial"><i class="fa fa-check"></i><b>5.1.2</b> Available R packages and tutorial</a></li>
<li class="chapter" data-level="5.1.3" data-path="advanced-network-visualization.html"><a href="advanced-network-visualization.html#references-2"><i class="fa fa-check"></i><b>5.1.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="advanced-network-visualization.html"><a href="advanced-network-visualization.html#preparation-5"><i class="fa fa-check"></i><b>5.2</b> Preparation</a></li>
<li class="chapter" data-level="5.3" data-path="advanced-network-visualization.html"><a href="advanced-network-visualization.html#visualization-for-static-network"><i class="fa fa-check"></i><b>5.3</b> Visualization for static network</a><ul>
<li class="chapter" data-level="5.3.1" data-path="advanced-network-visualization.html"><a href="advanced-network-visualization.html#hairball-plot"><i class="fa fa-check"></i><b>5.3.1</b> Hairball plot</a></li>
<li class="chapter" data-level="5.3.2" data-path="advanced-network-visualization.html"><a href="advanced-network-visualization.html#heatmap"><i class="fa fa-check"></i><b>5.3.2</b> Heatmap</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="advanced-network-visualization.html"><a href="advanced-network-visualization.html#other-static-networks"><i class="fa fa-check"></i><b>5.4</b> Other static networks</a><ul>
<li class="chapter" data-level="5.4.1" data-path="advanced-network-visualization.html"><a href="advanced-network-visualization.html#two-mode-network"><i class="fa fa-check"></i><b>5.4.1</b> Two-mode network</a></li>
<li class="chapter" data-level="5.4.2" data-path="advanced-network-visualization.html"><a href="advanced-network-visualization.html#multiple-neworks"><i class="fa fa-check"></i><b>5.4.2</b> Multiple neworks</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="advanced-network-visualization.html"><a href="advanced-network-visualization.html#ggplot2-version-for-network-visualization"><i class="fa fa-check"></i><b>5.5</b> <code>ggplot2</code> version for network visualization</a><ul>
<li class="chapter" data-level="5.5.1" data-path="advanced-network-visualization.html"><a href="advanced-network-visualization.html#ggnet2geomnetggnetwork"><i class="fa fa-check"></i><b>5.5.1</b> <code>ggnet2</code>,<code>geomnet</code>,<code>ggnetwork</code></a></li>
<li class="chapter" data-level="5.5.2" data-path="advanced-network-visualization.html"><a href="advanced-network-visualization.html#football-data"><i class="fa fa-check"></i><b>5.5.2</b> football data</a></li>
<li class="chapter" data-level="5.5.3" data-path="advanced-network-visualization.html"><a href="advanced-network-visualization.html#ggnet2"><i class="fa fa-check"></i><b>5.5.3</b> <code>ggnet2</code></a></li>
<li class="chapter" data-level="5.5.4" data-path="advanced-network-visualization.html"><a href="advanced-network-visualization.html#geomnet"><i class="fa fa-check"></i><b>5.5.4</b> <code>geomnet</code></a></li>
<li class="chapter" data-level="5.5.5" data-path="advanced-network-visualization.html"><a href="advanced-network-visualization.html#ggnetwork"><i class="fa fa-check"></i><b>5.5.5</b> <code>ggnetwork</code></a></li>
<li class="chapter" data-level="5.5.6" data-path="advanced-network-visualization.html"><a href="advanced-network-visualization.html#extensions-of-ggnet2geomnetggnetwork"><i class="fa fa-check"></i><b>5.5.6</b> Extensions of <code>ggnet2</code>,<code>geomnet</code>,<code>ggnetwork</code></a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="advanced-network-visualization.html"><a href="advanced-network-visualization.html#interactive-network-visualization"><i class="fa fa-check"></i><b>5.6</b> Interactive network visualization</a></li>
<li class="chapter" data-level="5.7" data-path="advanced-network-visualization.html"><a href="advanced-network-visualization.html#dynamic-network"><i class="fa fa-check"></i><b>5.7</b> Dynamic network</a><ul>
<li class="chapter" data-level="5.7.1" data-path="advanced-network-visualization.html"><a href="advanced-network-visualization.html#introduction-5"><i class="fa fa-check"></i><b>5.7.1</b> Introduction</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="amen-packages.html"><a href="amen-packages.html"><i class="fa fa-check"></i><b>6</b> <code>amen</code> packages</a><ul>
<li class="chapter" data-level="6.1" data-path="amen-packages.html"><a href="amen-packages.html#outline-6"><i class="fa fa-check"></i><b>6.1</b> Outline</a></li>
<li class="chapter" data-level="6.2" data-path="amen-packages.html"><a href="amen-packages.html#ame"><i class="fa fa-check"></i><b>6.2</b> <code>ame()</code></a></li>
<li class="chapter" data-level="6.3" data-path="amen-packages.html"><a href="amen-packages.html#input-prepare-the-dataset"><i class="fa fa-check"></i><b>6.3</b> Input: prepare the dataset</a></li>
<li class="chapter" data-level="6.4" data-path="amen-packages.html"><a href="amen-packages.html#fit-the-model-the-gaussian-ame-model-continuous-y"><i class="fa fa-check"></i><b>6.4</b> Fit the model: the Gaussian AME model (continuous Y)</a><ul>
<li class="chapter" data-level="6.4.1" data-path="amen-packages.html"><a href="amen-packages.html#the-gaussian-ame-model"><i class="fa fa-check"></i><b>6.4.1</b> The Gaussian AME model</a></li>
<li class="chapter" data-level="6.4.2" data-path="amen-packages.html"><a href="amen-packages.html#social-relations-model-srm"><i class="fa fa-check"></i><b>6.4.2</b> Social relations model (SRM)</a></li>
<li class="chapter" data-level="6.4.3" data-path="amen-packages.html"><a href="amen-packages.html#social-relations-regression-model-srrm"><i class="fa fa-check"></i><b>6.4.3</b> Social relations regression model (SRRM)</a></li>
<li class="chapter" data-level="6.4.4" data-path="amen-packages.html"><a href="amen-packages.html#no-row-variance-column-variance-or-dyadic-correlation"><i class="fa fa-check"></i><b>6.4.4</b> No row variance, column variance or dyadic correlation</a></li>
<li class="chapter" data-level="6.4.5" data-path="amen-packages.html"><a href="amen-packages.html#additive-and-multiplicative-effects-model-ame"><i class="fa fa-check"></i><b>6.4.5</b> additive and multiplicative effects model (ame)</a></li>
<li class="chapter" data-level="6.4.6" data-path="amen-packages.html"><a href="amen-packages.html#circle-plot-for-estimated-latent-factor"><i class="fa fa-check"></i><b>6.4.6</b> circle plot for estimated latent factor</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="amen-packages.html"><a href="amen-packages.html#choice-of-model-in-ame-binary-ordinal-discrete-or-sparse-relations"><i class="fa fa-check"></i><b>6.5</b> Choice of <code>model</code> in <code>ame</code>: binary, ordinal, discrete or sparse relations</a><ul>
<li class="chapter" data-level="6.5.1" data-path="amen-packages.html"><a href="amen-packages.html#binary-outcome"><i class="fa fa-check"></i><b>6.5.1</b> binary outcome</a></li>
<li class="chapter" data-level="6.5.2" data-path="amen-packages.html"><a href="amen-packages.html#ordinal-outcome"><i class="fa fa-check"></i><b>6.5.2</b> ordinal outcome</a></li>
<li class="chapter" data-level="6.5.3" data-path="amen-packages.html"><a href="amen-packages.html#censored-and-fixed-rank-nomination-data"><i class="fa fa-check"></i><b>6.5.3</b> censored and fixed rank nomination data</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="amen-packages.html"><a href="amen-packages.html#symmetric-outcome-symmetrictrue"><i class="fa fa-check"></i><b>6.6</b> symmetric outcome: <code>symmetric=TRUE</code></a><ul>
<li class="chapter" data-level="6.6.1" data-path="amen-packages.html"><a href="amen-packages.html#symmetric-outcome-symmetrictrue-1"><i class="fa fa-check"></i><b>6.6.1</b> symmetric outcome: <code>symmetric=TRUE</code></a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="amen-packages.html"><a href="amen-packages.html#ame_rep-for-longitudinal-outcome"><i class="fa fa-check"></i><b>6.7</b> <code>ame_rep()</code> for longitudinal outcome</a><ul>
<li class="chapter" data-level="6.7.1" data-path="amen-packages.html"><a href="amen-packages.html#repeated-measures-data-longitudinal-outcome"><i class="fa fa-check"></i><b>6.7.1</b> repeated measures data: longitudinal outcome</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Network Analysis Using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="collect-network-data-and-api-requests" class="section level1">
<h1><span class="header-section-number">4</span> Collect network data and API requests</h1>
<div id="several-useful-websites" class="section level2">
<h2><span class="header-section-number">4.1</span> Several useful websites</h2>
<ul>
<li><a href="https://github.com/briatte/awesome-network-analysis">Papers, reviews, dataset, software (tutorial)</a></li>
<li><a href="http://kateto.net/2016/05/network-datasets/">Katherine’s webpage</a></li>
<li><a href="https://www.kaggle.com/datasets">Kaggle</a></li>
<li><a href="https://data.world/search?q=network+dataset">dataworld</a></li>
</ul>
</div>
<div id="web-scraping" class="section level2">
<h2><span class="header-section-number">4.2</span> Web scraping</h2>
<ul>
<li>Web APIs (application programming interface): website offers a set of structured http requests that return JSON or XML files.</li>
<li>R packages: <code>rtweet</code> (twitter), <code>Rfacebook</code> (facebook), <code>RedditExtractoR</code> (reddit), <code>imdbapi</code> (IMDB), <code>omdbapi</code>(The Open Movie Database).
<ul>
<li>Using <code>rtweet</code> to make API requests</li>
<li>Construct Retweet networks</li>
<li>Construct Friendship networks</li>
</ul></li>
<li>API request from R. <code>rjson</code> (map JSON file to datafram),<code>rvest</code> (web scrapping).</li>
</ul>
</div>
<div id="preparation-2" class="section level2">
<h2><span class="header-section-number">4.3</span> Preparation</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">library</span>(igraph)
<span class="kw">library</span>(purrr)
<span class="kw">library</span>(<span class="st">&quot;stringr&quot;</span>)</code></pre>
</div>
<div id="twitter-api-request" class="section level2">
<h2><span class="header-section-number">4.4</span> Twitter API request</h2>
<div id="r-package-rtweet" class="section level3">
<h3><span class="header-section-number">4.4.1</span> R package <code>rtweet</code></h3>
<p>Official website: <a href="https://rtweet.info/index.html" class="uri">https://rtweet.info/index.html</a></p>
<p><strong>Explore the official websites to find more info.</strong></p>
<ul>
<li>All the functions</li>
<li>Tutorial</li>
<li>FAQ (possible issues)</li>
</ul>
<p>Good documentation; Recommended over another R package <code>twitteR</code>.</p>
</div>
<div id="preparation-3" class="section level3">
<h3><span class="header-section-number">4.4.2</span> Preparation</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages(&quot;rtweet&quot;)</span>
<span class="kw">library</span>(<span class="st">&quot;rtweet&quot;</span>)</code></pre>
</div>
<div id="api-authorization" class="section level3">
<h3><span class="header-section-number">4.4.3</span> API authorization</h3>
<p>Follow <a href="https://rtweet.info/articles/auth.html" class="uri">https://rtweet.info/articles/auth.html</a></p>
<ul>
<li><p>Create a Twitter App</p></li>
<li><p>Authorization via access token: <code>create_token()</code> automatically saves your token as an environment variable, you’ll be set for future sessions as well!</p></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#save your token as an environment variable for you</span>
<span class="kw">create_token</span>(
  <span class="dt">app =</span> <span class="st">&quot;your_research_app&quot;</span>,
  <span class="dt">consumer_key =</span> <span class="st">&quot;consumer_API_key&quot;</span>,
  <span class="dt">consumer_secret =</span> <span class="st">&quot;consumer_API_secret_key&quot;</span>,
  <span class="dt">access_token =</span> <span class="st">&quot;access_token&quot;</span>,
  <span class="dt">access_secret =</span> <span class="st">&quot;access_token_secret&quot;</span>)</code></pre>
</div>
<div id="rtweet" class="section level3">
<h3><span class="header-section-number">4.4.4</span> <code>rtweet</code></h3>
<p><strong>API request</strong></p>
<ul>
<li><a href="https://developer.twitter.com/en/docs/tweets/search/api-reference/get-search-tweets">Tweeter Developer</a></li>
<li>Send a request specifying parameters; Get response in JSON format</li>
<li><code>search_tweets</code>: <strong>sampling</strong> from tweets in past 7 days matching keywords (<strong>specified # of tweets</strong>) – recent/popular/mixed</li>
<li><code>stream_tweets</code>: sampling/keyword-filter/user-track/geo-location <strong>live stream</strong> for future time period;(<strong>specified time period</strong>)</li>
</ul>
<div id="search_tweets" class="section level4">
<h4><span class="header-section-number">4.4.4.1</span> <code>search_tweets</code></h4>
<ul>
<li>limiting searches to 10 keywords and operators</li>
<li>only past 6-9 days of Tweets</li>
</ul>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>help()</code> or see <a href="https://developer.twitter.com/en/docs/tweets/search/api-reference/get-search-tweets" class="uri">https://developer.twitter.com/en/docs/tweets/search/api-reference/get-search-tweets</a></li>
<li><code>q</code>: Query to be searched.
<ul>
<li>Spaces/AND – both (“data science”;“data AND science”);</li>
<li>OR – either or (data OR science);</li>
<li>’&quot;“’ – exact (‘“data science”’;”&quot;data science&quot;&quot;);</li>
<li>“#datascience” – track hashtag;</li>
<li>“@duke” – track at.</li>
<li><a href="https://developer.twitter.com/en/docs/tweets/rules-and-filtering/overview/standard-operators.html">More about operators</a></li>
</ul></li>
<li><code>n</code>: total number of desired tweets.
<ul>
<li>At most 18,000 in a single call;</li>
<li>For <span class="math inline">\(&gt;\)</span> 18,000, <code>retryonratelimit</code>=TRUE</li>
</ul></li>
<li><code>type</code>: “recent”,“popular”,“mixed”</li>
<li><code>include_rts</code>: whether to include retweets</li>
<li><code>geocode</code>: “latitude,longitude,radius”</li>
<li><code>lang</code>: language</li>
<li><code>parse</code>: TRUE(dateframe); FALSE(list)</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">rt &lt;-<span class="st"> </span><span class="kw">search_tweets</span>(
  <span class="dt">q=</span><span class="st">&quot;#dukebasketball&quot;</span>, <span class="co">#Query to be searched</span>
  <span class="dt">n =</span> <span class="dv">10</span>,
<span class="dt">include_rts=</span><span class="ot">FALSE</span>,
<span class="dt">result_type=</span><span class="st">&quot;recent&quot;</span>,
<span class="dt">geocode =</span> <span class="st">&quot;36.00,-78.94,5mi&quot;</span>
)</code></pre>
<pre><code>## Searching for tweets...</code></pre>
<pre><code>## Finished collecting tweets!</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">rt</code></pre>
<pre><code>## # A tibble: 4 x 88
##   user_id status_id created_at          screen_name text  source
##   &lt;chr&gt;   &lt;chr&gt;     &lt;dttm&gt;              &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt; 
## 1 109257… 11208030… 2019-04-23 21:34:08 rj5nation   &quot;Do … Twitt…
## 2 109257… 11200524… 2019-04-21 19:51:29 rj5nation   &quot;Tag… Twitt…
## 3 109257… 11196528… 2019-04-20 17:23:31 rj5nation   &quot;NBA… Twitt…
## 4 202752… 11207366… 2019-04-23 17:10:09 BlueBloodR… &quot;#Re… Insta…
## # … with 82 more variables: display_text_width &lt;dbl&gt;,
## #   reply_to_status_id &lt;lgl&gt;, reply_to_user_id &lt;lgl&gt;,
## #   reply_to_screen_name &lt;lgl&gt;, is_quote &lt;lgl&gt;, is_retweet &lt;lgl&gt;,
## #   favorite_count &lt;int&gt;, retweet_count &lt;int&gt;, hashtags &lt;list&gt;,
## #   symbols &lt;list&gt;, urls_url &lt;list&gt;, urls_t.co &lt;list&gt;,
## #   urls_expanded_url &lt;list&gt;, media_url &lt;list&gt;, media_t.co &lt;list&gt;,
## #   media_expanded_url &lt;list&gt;, media_type &lt;list&gt;, ext_media_url &lt;list&gt;,
## #   ext_media_t.co &lt;list&gt;, ext_media_expanded_url &lt;list&gt;,
## #   ext_media_type &lt;chr&gt;, mentions_user_id &lt;list&gt;,
## #   mentions_screen_name &lt;list&gt;, lang &lt;chr&gt;, quoted_status_id &lt;chr&gt;,
## #   quoted_text &lt;chr&gt;, quoted_created_at &lt;dttm&gt;, quoted_source &lt;chr&gt;,
## #   quoted_favorite_count &lt;int&gt;, quoted_retweet_count &lt;int&gt;,
## #   quoted_user_id &lt;chr&gt;, quoted_screen_name &lt;chr&gt;, quoted_name &lt;chr&gt;,
## #   quoted_followers_count &lt;int&gt;, quoted_friends_count &lt;int&gt;,
## #   quoted_statuses_count &lt;int&gt;, quoted_location &lt;chr&gt;,
## #   quoted_description &lt;chr&gt;, quoted_verified &lt;lgl&gt;,
## #   retweet_status_id &lt;chr&gt;, retweet_text &lt;chr&gt;,
## #   retweet_created_at &lt;dttm&gt;, retweet_source &lt;chr&gt;,
## #   retweet_favorite_count &lt;int&gt;, retweet_retweet_count &lt;int&gt;,
## #   retweet_user_id &lt;chr&gt;, retweet_screen_name &lt;chr&gt;, retweet_name &lt;chr&gt;,
## #   retweet_followers_count &lt;int&gt;, retweet_friends_count &lt;int&gt;,
## #   retweet_statuses_count &lt;int&gt;, retweet_location &lt;chr&gt;,
## #   retweet_description &lt;chr&gt;, retweet_verified &lt;lgl&gt;, place_url &lt;chr&gt;,
## #   place_name &lt;chr&gt;, place_full_name &lt;chr&gt;, place_type &lt;chr&gt;,
## #   country &lt;chr&gt;, country_code &lt;chr&gt;, geo_coords &lt;list&gt;,
## #   coords_coords &lt;list&gt;, bbox_coords &lt;list&gt;, status_url &lt;chr&gt;,
## #   name &lt;chr&gt;, location &lt;chr&gt;, description &lt;chr&gt;, url &lt;chr&gt;,
## #   protected &lt;lgl&gt;, followers_count &lt;int&gt;, friends_count &lt;int&gt;,
## #   listed_count &lt;int&gt;, statuses_count &lt;int&gt;, favourites_count &lt;int&gt;,
## #   account_created_at &lt;dttm&gt;, verified &lt;lgl&gt;, profile_url &lt;chr&gt;,
## #   profile_expanded_url &lt;chr&gt;, account_lang &lt;chr&gt;,
## #   profile_banner_url &lt;chr&gt;, profile_background_url &lt;chr&gt;,
## #   profile_image_url &lt;chr&gt;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">rt &lt;-<span class="st"> </span><span class="kw">search_tweets</span>(
  <span class="st">&quot;trump OR president&quot;</span>, <span class="dt">n =</span> <span class="dv">10</span>,
  <span class="dt">lang =</span> <span class="st">&quot;en&quot;</span>
)</code></pre>
<pre><code>## Searching for tweets...
## Finished collecting tweets!</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">rt</code></pre>
<pre><code>## # A tibble: 8 x 88
##   user_id status_id created_at          screen_name text  source
##   &lt;chr&gt;   &lt;chr&gt;     &lt;dttm&gt;              &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt; 
## 1 227299… 11222551… 2019-04-27 21:44:10 PSheppardTV &quot;For… Twitt…
## 2 282827… 11222551… 2019-04-27 21:44:10 mkthomas    @Aly… Twitt…
## 3 246839… 11222551… 2019-04-27 21:44:10 JeffTeichr… @Fir… Twitt…
## 4 193587… 11222551… 2019-04-27 21:44:10 7thgatefil… &quot;In … Twitt…
## 5 744894… 11222551… 2019-04-27 21:44:10 Cascada57   By r… Twitt…
## 6 864062… 11222551… 2019-04-27 21:44:10 Rowdystyle… Rais… Twitt…
## 7 319082… 11222551… 2019-04-27 21:44:10 stemcellpa… &quot;Ave… Twitt…
## 8 110678… 11222551… 2019-04-27 21:44:10 SHERIFFPT   &quot;\&quot;L… Twitt…
## # … with 82 more variables: display_text_width &lt;dbl&gt;,
## #   reply_to_status_id &lt;chr&gt;, reply_to_user_id &lt;chr&gt;,
## #   reply_to_screen_name &lt;chr&gt;, is_quote &lt;lgl&gt;, is_retweet &lt;lgl&gt;,
## #   favorite_count &lt;int&gt;, retweet_count &lt;int&gt;, hashtags &lt;list&gt;,
## #   symbols &lt;list&gt;, urls_url &lt;list&gt;, urls_t.co &lt;list&gt;,
## #   urls_expanded_url &lt;list&gt;, media_url &lt;list&gt;, media_t.co &lt;list&gt;,
## #   media_expanded_url &lt;list&gt;, media_type &lt;list&gt;, ext_media_url &lt;list&gt;,
## #   ext_media_t.co &lt;list&gt;, ext_media_expanded_url &lt;list&gt;,
## #   ext_media_type &lt;chr&gt;, mentions_user_id &lt;list&gt;,
## #   mentions_screen_name &lt;list&gt;, lang &lt;chr&gt;, quoted_status_id &lt;chr&gt;,
## #   quoted_text &lt;chr&gt;, quoted_created_at &lt;dttm&gt;, quoted_source &lt;chr&gt;,
## #   quoted_favorite_count &lt;int&gt;, quoted_retweet_count &lt;int&gt;,
## #   quoted_user_id &lt;chr&gt;, quoted_screen_name &lt;chr&gt;, quoted_name &lt;chr&gt;,
## #   quoted_followers_count &lt;int&gt;, quoted_friends_count &lt;int&gt;,
## #   quoted_statuses_count &lt;int&gt;, quoted_location &lt;chr&gt;,
## #   quoted_description &lt;chr&gt;, quoted_verified &lt;lgl&gt;,
## #   retweet_status_id &lt;chr&gt;, retweet_text &lt;chr&gt;,
## #   retweet_created_at &lt;dttm&gt;, retweet_source &lt;chr&gt;,
## #   retweet_favorite_count &lt;int&gt;, retweet_retweet_count &lt;int&gt;,
## #   retweet_user_id &lt;chr&gt;, retweet_screen_name &lt;chr&gt;, retweet_name &lt;chr&gt;,
## #   retweet_followers_count &lt;int&gt;, retweet_friends_count &lt;int&gt;,
## #   retweet_statuses_count &lt;int&gt;, retweet_location &lt;chr&gt;,
## #   retweet_description &lt;chr&gt;, retweet_verified &lt;lgl&gt;, place_url &lt;chr&gt;,
## #   place_name &lt;chr&gt;, place_full_name &lt;chr&gt;, place_type &lt;chr&gt;,
## #   country &lt;chr&gt;, country_code &lt;chr&gt;, geo_coords &lt;list&gt;,
## #   coords_coords &lt;list&gt;, bbox_coords &lt;list&gt;, status_url &lt;chr&gt;,
## #   name &lt;chr&gt;, location &lt;chr&gt;, description &lt;chr&gt;, url &lt;chr&gt;,
## #   protected &lt;lgl&gt;, followers_count &lt;int&gt;, friends_count &lt;int&gt;,
## #   listed_count &lt;int&gt;, statuses_count &lt;int&gt;, favourites_count &lt;int&gt;,
## #   account_created_at &lt;dttm&gt;, verified &lt;lgl&gt;, profile_url &lt;chr&gt;,
## #   profile_expanded_url &lt;chr&gt;, account_lang &lt;chr&gt;,
## #   profile_banner_url &lt;chr&gt;, profile_background_url &lt;chr&gt;,
## #   profile_image_url &lt;chr&gt;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">search_tweets</span>(
  <span class="dt">q=</span><span class="st">&quot;#dukebasketball&quot;</span>, <span class="co">#Query to be searched</span>
  <span class="dt">n =</span> <span class="dv">10</span>,
<span class="dt">include_rts=</span><span class="ot">FALSE</span>,
<span class="dt">result_type=</span><span class="st">&quot;recent&quot;</span>,
<span class="dt">geocode =</span> <span class="st">&quot;36.00,-78.94,5mi&quot;</span>
)</code></pre>
<pre><code>## Searching for tweets...
## Finished collecting tweets!</code></pre>
<pre><code>## # A tibble: 4 x 88
##   user_id status_id created_at          screen_name text  source
##   &lt;chr&gt;   &lt;chr&gt;     &lt;dttm&gt;              &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt; 
## 1 109257… 11208030… 2019-04-23 21:34:08 rj5nation   &quot;Do … Twitt…
## 2 109257… 11200524… 2019-04-21 19:51:29 rj5nation   &quot;Tag… Twitt…
## 3 109257… 11196528… 2019-04-20 17:23:31 rj5nation   &quot;NBA… Twitt…
## 4 202752… 11207366… 2019-04-23 17:10:09 BlueBloodR… &quot;#Re… Insta…
## # … with 82 more variables: display_text_width &lt;dbl&gt;,
## #   reply_to_status_id &lt;lgl&gt;, reply_to_user_id &lt;lgl&gt;,
## #   reply_to_screen_name &lt;lgl&gt;, is_quote &lt;lgl&gt;, is_retweet &lt;lgl&gt;,
## #   favorite_count &lt;int&gt;, retweet_count &lt;int&gt;, hashtags &lt;list&gt;,
## #   symbols &lt;list&gt;, urls_url &lt;list&gt;, urls_t.co &lt;list&gt;,
## #   urls_expanded_url &lt;list&gt;, media_url &lt;list&gt;, media_t.co &lt;list&gt;,
## #   media_expanded_url &lt;list&gt;, media_type &lt;list&gt;, ext_media_url &lt;list&gt;,
## #   ext_media_t.co &lt;list&gt;, ext_media_expanded_url &lt;list&gt;,
## #   ext_media_type &lt;chr&gt;, mentions_user_id &lt;list&gt;,
## #   mentions_screen_name &lt;list&gt;, lang &lt;chr&gt;, quoted_status_id &lt;chr&gt;,
## #   quoted_text &lt;chr&gt;, quoted_created_at &lt;dttm&gt;, quoted_source &lt;chr&gt;,
## #   quoted_favorite_count &lt;int&gt;, quoted_retweet_count &lt;int&gt;,
## #   quoted_user_id &lt;chr&gt;, quoted_screen_name &lt;chr&gt;, quoted_name &lt;chr&gt;,
## #   quoted_followers_count &lt;int&gt;, quoted_friends_count &lt;int&gt;,
## #   quoted_statuses_count &lt;int&gt;, quoted_location &lt;chr&gt;,
## #   quoted_description &lt;chr&gt;, quoted_verified &lt;lgl&gt;,
## #   retweet_status_id &lt;chr&gt;, retweet_text &lt;chr&gt;,
## #   retweet_created_at &lt;dttm&gt;, retweet_source &lt;chr&gt;,
## #   retweet_favorite_count &lt;int&gt;, retweet_retweet_count &lt;int&gt;,
## #   retweet_user_id &lt;chr&gt;, retweet_screen_name &lt;chr&gt;, retweet_name &lt;chr&gt;,
## #   retweet_followers_count &lt;int&gt;, retweet_friends_count &lt;int&gt;,
## #   retweet_statuses_count &lt;int&gt;, retweet_location &lt;chr&gt;,
## #   retweet_description &lt;chr&gt;, retweet_verified &lt;lgl&gt;, place_url &lt;chr&gt;,
## #   place_name &lt;chr&gt;, place_full_name &lt;chr&gt;, place_type &lt;chr&gt;,
## #   country &lt;chr&gt;, country_code &lt;chr&gt;, geo_coords &lt;list&gt;,
## #   coords_coords &lt;list&gt;, bbox_coords &lt;list&gt;, status_url &lt;chr&gt;,
## #   name &lt;chr&gt;, location &lt;chr&gt;, description &lt;chr&gt;, url &lt;chr&gt;,
## #   protected &lt;lgl&gt;, followers_count &lt;int&gt;, friends_count &lt;int&gt;,
## #   listed_count &lt;int&gt;, statuses_count &lt;int&gt;, favourites_count &lt;int&gt;,
## #   account_created_at &lt;dttm&gt;, verified &lt;lgl&gt;, profile_url &lt;chr&gt;,
## #   profile_expanded_url &lt;chr&gt;, account_lang &lt;chr&gt;,
## #   profile_banner_url &lt;chr&gt;, profile_background_url &lt;chr&gt;,
## #   profile_image_url &lt;chr&gt;</code></pre>
<hr />
<ul>
<li>dataframe: each row a tweet</li>
<li><code>users_data</code>: only extract user-related column</li>
<li><code>ts_plot</code></li>
<li><code>lat_lng</code></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## search for 18000 tweets using the rstats hashtag</span>
rt &lt;-<span class="st"> </span><span class="kw">search_tweets</span>(
  <span class="st">&quot;#dukebasketball&quot;</span>, <span class="dt">n =</span> <span class="dv">50000</span>, <span class="dt">include_rts =</span> <span class="ot">FALSE</span>,
  <span class="dt">geocode =</span> <span class="st">&quot;36.00,-78.94,2000mi&quot;</span>
)</code></pre>
<pre><code>## Searching for tweets...</code></pre>
<pre><code>## This may take a few seconds...</code></pre>
<pre><code>## Finished collecting tweets!</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">rt_dmbb=rt
<span class="kw">class</span>(rt)</code></pre>
<pre><code>## [1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## preview tweets data</span>
<span class="kw">names</span>(rt)</code></pre>
<pre><code>##  [1] &quot;user_id&quot;                 &quot;status_id&quot;              
##  [3] &quot;created_at&quot;              &quot;screen_name&quot;            
##  [5] &quot;text&quot;                    &quot;source&quot;                 
##  [7] &quot;display_text_width&quot;      &quot;reply_to_status_id&quot;     
##  [9] &quot;reply_to_user_id&quot;        &quot;reply_to_screen_name&quot;   
## [11] &quot;is_quote&quot;                &quot;is_retweet&quot;             
## [13] &quot;favorite_count&quot;          &quot;retweet_count&quot;          
## [15] &quot;hashtags&quot;                &quot;symbols&quot;                
## [17] &quot;urls_url&quot;                &quot;urls_t.co&quot;              
## [19] &quot;urls_expanded_url&quot;       &quot;media_url&quot;              
## [21] &quot;media_t.co&quot;              &quot;media_expanded_url&quot;     
## [23] &quot;media_type&quot;              &quot;ext_media_url&quot;          
## [25] &quot;ext_media_t.co&quot;          &quot;ext_media_expanded_url&quot; 
## [27] &quot;ext_media_type&quot;          &quot;mentions_user_id&quot;       
## [29] &quot;mentions_screen_name&quot;    &quot;lang&quot;                   
## [31] &quot;quoted_status_id&quot;        &quot;quoted_text&quot;            
## [33] &quot;quoted_created_at&quot;       &quot;quoted_source&quot;          
## [35] &quot;quoted_favorite_count&quot;   &quot;quoted_retweet_count&quot;   
## [37] &quot;quoted_user_id&quot;          &quot;quoted_screen_name&quot;     
## [39] &quot;quoted_name&quot;             &quot;quoted_followers_count&quot; 
## [41] &quot;quoted_friends_count&quot;    &quot;quoted_statuses_count&quot;  
## [43] &quot;quoted_location&quot;         &quot;quoted_description&quot;     
## [45] &quot;quoted_verified&quot;         &quot;retweet_status_id&quot;      
## [47] &quot;retweet_text&quot;            &quot;retweet_created_at&quot;     
## [49] &quot;retweet_source&quot;          &quot;retweet_favorite_count&quot; 
## [51] &quot;retweet_retweet_count&quot;   &quot;retweet_user_id&quot;        
## [53] &quot;retweet_screen_name&quot;     &quot;retweet_name&quot;           
## [55] &quot;retweet_followers_count&quot; &quot;retweet_friends_count&quot;  
## [57] &quot;retweet_statuses_count&quot;  &quot;retweet_location&quot;       
## [59] &quot;retweet_description&quot;     &quot;retweet_verified&quot;       
## [61] &quot;place_url&quot;               &quot;place_name&quot;             
## [63] &quot;place_full_name&quot;         &quot;place_type&quot;             
## [65] &quot;country&quot;                 &quot;country_code&quot;           
## [67] &quot;geo_coords&quot;              &quot;coords_coords&quot;          
## [69] &quot;bbox_coords&quot;             &quot;status_url&quot;             
## [71] &quot;name&quot;                    &quot;location&quot;               
## [73] &quot;description&quot;             &quot;url&quot;                    
## [75] &quot;protected&quot;               &quot;followers_count&quot;        
## [77] &quot;friends_count&quot;           &quot;listed_count&quot;           
## [79] &quot;statuses_count&quot;          &quot;favourites_count&quot;       
## [81] &quot;account_created_at&quot;      &quot;verified&quot;               
## [83] &quot;profile_url&quot;             &quot;profile_expanded_url&quot;   
## [85] &quot;account_lang&quot;            &quot;profile_banner_url&quot;     
## [87] &quot;profile_background_url&quot;  &quot;profile_image_url&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## preview users data</span>
<span class="kw">users_data</span>(rt)<span class="op">%&gt;%</span><span class="kw">names</span>()</code></pre>
<pre><code>##  [1] &quot;user_id&quot;                &quot;screen_name&quot;           
##  [3] &quot;name&quot;                   &quot;location&quot;              
##  [5] &quot;description&quot;            &quot;url&quot;                   
##  [7] &quot;protected&quot;              &quot;followers_count&quot;       
##  [9] &quot;friends_count&quot;          &quot;listed_count&quot;          
## [11] &quot;statuses_count&quot;         &quot;favourites_count&quot;      
## [13] &quot;account_created_at&quot;     &quot;verified&quot;              
## [15] &quot;profile_url&quot;            &quot;profile_expanded_url&quot;  
## [17] &quot;account_lang&quot;           &quot;profile_banner_url&quot;    
## [19] &quot;profile_background_url&quot; &quot;profile_image_url&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## plot time series (if ggplot2 is installed)</span>
<span class="kw">ts_plot</span>(rt) <span class="co">#Duke vs No. 16 Louisville</span></code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-125-1.png" width="672" /></p>
</div>
<div id="search_tweets2" class="section level4">
<h4><span class="header-section-number">4.4.4.2</span> <code>search_tweets2</code></h4>
<p>Search different queries independently.</p>
<p>Other parameters are the same.</p>
<pre class="sourceCode r"><code class="sourceCode r">st2 &lt;-<span class="st"> </span><span class="kw">search_tweets2</span>(
  <span class="kw">c</span>(<span class="st">&quot;</span><span class="ch">\&quot;</span><span class="st">data science</span><span class="ch">\&quot;</span><span class="st">&quot;</span>, <span class="st">&quot;rstats OR python&quot;</span>),
  <span class="dt">n =</span> <span class="dv">50</span>
)</code></pre>
<pre><code>## Searching for tweets...</code></pre>
<pre><code>## Finished collecting tweets!</code></pre>
<pre><code>## Searching for tweets...</code></pre>
<pre><code>## Finished collecting tweets!</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">st2<span class="op">$</span>query</code></pre>
<pre><code>##  [1] &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot;
##  [4] &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot;
##  [7] &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot;
## [10] &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot;
## [13] &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot;
## [16] &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot;
## [19] &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot;
## [22] &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot;
## [25] &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot;
## [28] &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot;
## [31] &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot;
## [34] &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot;
## [37] &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot;
## [40] &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot;
## [43] &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot;
## [46] &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot;
## [49] &quot;\&quot;data science\&quot;&quot; &quot;\&quot;data science\&quot;&quot; &quot;rstats OR python&quot;
## [52] &quot;rstats OR python&quot; &quot;rstats OR python&quot; &quot;rstats OR python&quot;
## [55] &quot;rstats OR python&quot; &quot;rstats OR python&quot; &quot;rstats OR python&quot;
## [58] &quot;rstats OR python&quot; &quot;rstats OR python&quot; &quot;rstats OR python&quot;
## [61] &quot;rstats OR python&quot; &quot;rstats OR python&quot; &quot;rstats OR python&quot;
## [64] &quot;rstats OR python&quot; &quot;rstats OR python&quot; &quot;rstats OR python&quot;
## [67] &quot;rstats OR python&quot; &quot;rstats OR python&quot; &quot;rstats OR python&quot;
## [70] &quot;rstats OR python&quot; &quot;rstats OR python&quot; &quot;rstats OR python&quot;
## [73] &quot;rstats OR python&quot; &quot;rstats OR python&quot; &quot;rstats OR python&quot;
## [76] &quot;rstats OR python&quot; &quot;rstats OR python&quot; &quot;rstats OR python&quot;
## [79] &quot;rstats OR python&quot; &quot;rstats OR python&quot; &quot;rstats OR python&quot;
## [82] &quot;rstats OR python&quot; &quot;rstats OR python&quot; &quot;rstats OR python&quot;
## [85] &quot;rstats OR python&quot; &quot;rstats OR python&quot; &quot;rstats OR python&quot;
## [88] &quot;rstats OR python&quot; &quot;rstats OR python&quot; &quot;rstats OR python&quot;
## [91] &quot;rstats OR python&quot; &quot;rstats OR python&quot; &quot;rstats OR python&quot;
## [94] &quot;rstats OR python&quot; &quot;rstats OR python&quot; &quot;rstats OR python&quot;
## [97] &quot;rstats OR python&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(st2)</code></pre>
<pre><code>##  [1] &quot;user_id&quot;                 &quot;status_id&quot;              
##  [3] &quot;created_at&quot;              &quot;screen_name&quot;            
##  [5] &quot;text&quot;                    &quot;source&quot;                 
##  [7] &quot;display_text_width&quot;      &quot;reply_to_status_id&quot;     
##  [9] &quot;reply_to_user_id&quot;        &quot;reply_to_screen_name&quot;   
## [11] &quot;is_quote&quot;                &quot;is_retweet&quot;             
## [13] &quot;favorite_count&quot;          &quot;retweet_count&quot;          
## [15] &quot;hashtags&quot;                &quot;symbols&quot;                
## [17] &quot;urls_url&quot;                &quot;urls_t.co&quot;              
## [19] &quot;urls_expanded_url&quot;       &quot;media_url&quot;              
## [21] &quot;media_t.co&quot;              &quot;media_expanded_url&quot;     
## [23] &quot;media_type&quot;              &quot;ext_media_url&quot;          
## [25] &quot;ext_media_t.co&quot;          &quot;ext_media_expanded_url&quot; 
## [27] &quot;ext_media_type&quot;          &quot;mentions_user_id&quot;       
## [29] &quot;mentions_screen_name&quot;    &quot;lang&quot;                   
## [31] &quot;quoted_status_id&quot;        &quot;quoted_text&quot;            
## [33] &quot;quoted_created_at&quot;       &quot;quoted_source&quot;          
## [35] &quot;quoted_favorite_count&quot;   &quot;quoted_retweet_count&quot;   
## [37] &quot;quoted_user_id&quot;          &quot;quoted_screen_name&quot;     
## [39] &quot;quoted_name&quot;             &quot;quoted_followers_count&quot; 
## [41] &quot;quoted_friends_count&quot;    &quot;quoted_statuses_count&quot;  
## [43] &quot;quoted_location&quot;         &quot;quoted_description&quot;     
## [45] &quot;quoted_verified&quot;         &quot;retweet_status_id&quot;      
## [47] &quot;retweet_text&quot;            &quot;retweet_created_at&quot;     
## [49] &quot;retweet_source&quot;          &quot;retweet_favorite_count&quot; 
## [51] &quot;retweet_retweet_count&quot;   &quot;retweet_user_id&quot;        
## [53] &quot;retweet_screen_name&quot;     &quot;retweet_name&quot;           
## [55] &quot;retweet_followers_count&quot; &quot;retweet_friends_count&quot;  
## [57] &quot;retweet_statuses_count&quot;  &quot;retweet_location&quot;       
## [59] &quot;retweet_description&quot;     &quot;retweet_verified&quot;       
## [61] &quot;place_url&quot;               &quot;place_name&quot;             
## [63] &quot;place_full_name&quot;         &quot;place_type&quot;             
## [65] &quot;country&quot;                 &quot;country_code&quot;           
## [67] &quot;geo_coords&quot;              &quot;coords_coords&quot;          
## [69] &quot;bbox_coords&quot;             &quot;status_url&quot;             
## [71] &quot;name&quot;                    &quot;location&quot;               
## [73] &quot;description&quot;             &quot;url&quot;                    
## [75] &quot;protected&quot;               &quot;followers_count&quot;        
## [77] &quot;friends_count&quot;           &quot;listed_count&quot;           
## [79] &quot;statuses_count&quot;          &quot;favourites_count&quot;       
## [81] &quot;account_created_at&quot;      &quot;verified&quot;               
## [83] &quot;profile_url&quot;             &quot;profile_expanded_url&quot;   
## [85] &quot;account_lang&quot;            &quot;profile_banner_url&quot;     
## [87] &quot;profile_background_url&quot;  &quot;profile_image_url&quot;      
## [89] &quot;query&quot;</code></pre>
</div>
<div id="visualization-2" class="section level4">
<h4><span class="header-section-number">4.4.4.3</span> Visualization</h4>
<p><code>research_tweets</code> returns a dataframe. Visualization based on the dataframe.</p>
<ul>
<li><code>ts_plot</code>: Creates a ggplot2 plot of the frequency of tweets over a specified interval of time. Using <code>ggplot2</code>;</li>
<li>Map: Using <code>lat_lng</code></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## plot time series of tweets</span>
<span class="kw">ts_plot</span>(rt_dmbb, <span class="st">&quot;3 hours&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># a ggplot object</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">theme_minimal</span>() <span class="op">+</span><span class="st"> </span><span class="co"># Add multiple layers directly</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">theme</span>(<span class="dt">plot.title =</span> ggplot2<span class="op">::</span><span class="kw">element_text</span>(<span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>)) <span class="op">+</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">labs</span>(
    <span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>,
    <span class="dt">title =</span> <span class="st">&quot;Frequency of #dukebasketball Twitter statuses from past 6-9 days&quot;</span>,
    <span class="dt">subtitle =</span> <span class="st">&quot;Twitter status (tweet) counts aggregated using three-hour intervals&quot;</span>,
    <span class="dt">caption =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Source: Data collected from Twitter&#39;s REST API via rtweet&quot;</span>
  )</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-127-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># an example using `groupby` with ggplot2</span>
<span class="kw">ts_plot</span>(rt_dmbb<span class="op">%&gt;%</span>dplyr<span class="op">::</span><span class="kw">group_by</span>(is_quote), <span class="st">&quot;3 hours&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># a ggplot object</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">theme_minimal</span>()</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-127-2.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages(&quot;maps&quot;)</span>
<span class="co">## create lat/lng variables using all available tweet and profile geo-location data</span>
rt_dmbbll &lt;-<span class="st"> </span><span class="kw">lat_lng</span>(rt_dmbb)
<span class="kw">names</span>(rt_dmbbll)[<span class="op">!</span><span class="kw">names</span>(rt_dmbbll)<span class="op">%in%</span><span class="kw">names</span>(rt_dmbb)]</code></pre>
<pre><code>## [1] &quot;lat&quot; &quot;lng&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## plot state boundaries</span>
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))
maps<span class="op">::</span><span class="kw">map</span>(<span class="st">&quot;state&quot;</span>,<span class="st">&quot;north carolina&quot;</span>, <span class="dt">lwd =</span> <span class="fl">.25</span>)

<span class="co">## plot lat and lng points onto state map</span>
<span class="kw">with</span>(rt_dmbbll, <span class="kw">points</span>(lng, lat, <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">cex =</span> <span class="fl">.75</span>, <span class="dt">col =</span> <span class="kw">rgb</span>(<span class="dv">0</span>, <span class="fl">.3</span>, <span class="fl">.7</span>, <span class="fl">.75</span>)))</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-128-1.png" width="672" /></p>
</div>
<div id="stream_tweets" class="section level4">
<h4><span class="header-section-number">4.4.4.4</span> <code>stream_tweets</code></h4>
<p><a href="https://developer.twitter.com/en/docs/tweets/search/api-reference/get-search-tweets" class="uri">https://developer.twitter.com/en/docs/tweets/search/api-reference/get-search-tweets</a></p>
<ul>
<li><code>q</code>
<ul>
<li>Sampling a small random sample of all publicly available tweets <code>q=&quot;&quot;</code></li>
<li>Filtering via a search-like query (up to 400 keywords) <code>q=&quot;duke,basketball&quot;</code>. “,” separation</li>
<li>Tracking via vector of user ids (up to 5000 user_ids) <code>q=&quot;hillaryclinton,realdonaldtrump&quot;</code>. “,” separation</li>
<li>Location via geo coordinates (1-360 degree location boxes) <code>q=c(-125, 26, -65, 49)</code></li>
</ul></li>
<li><code>timeout</code> : amount of time (seconds) <strong>occupy your r session</strong></li>
<li><code>parse</code>: TRUE(dataframe); FALSE(JSON).</li>
<li><code>file_name</code>: save as a file</li>
</ul>
<p><strong>Usually the file is large. Recommend to save as JSON file then parse to data.frame.</strong></p>
<p>To ensure the stream automatically reconnects following any interruption prior to the specified stream time, use <code>stream_tweets2()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## Randomly sample (approximately 1%) from the live stream of all tweets for 30 seconds (default)</span>
rt &lt;-<span class="st"> </span><span class="kw">stream_tweets</span>(<span class="st">&quot;&quot;</span>)</code></pre>
<pre><code>## Streaming tweets for 30 seconds...</code></pre>
<pre><code>## Finished streaming tweets!</code></pre>
<pre><code>## opening file input connection.</code></pre>
<pre><code>## 
 Found 500 records...
 Found 1000 records...
 Found 1068 records...
 Imported 1068 records. Simplifying...</code></pre>
<pre><code>## closing file input connection.</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nrow</span>(rt)</code></pre>
<pre><code>## [1] 1068</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">rt &lt;-<span class="st"> </span><span class="kw">stream_tweets</span>(<span class="st">&quot;duke,bluedevil,unc&quot;</span>)</code></pre>
<pre><code>## Streaming tweets for 30 seconds...</code></pre>
<pre><code>## Finished streaming tweets!</code></pre>
<pre><code>## opening file input connection.</code></pre>
<pre><code>## 
 Found 22 records...
 Imported 22 records. Simplifying...</code></pre>
<pre><code>## closing file input connection.</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nrow</span>(rt)</code></pre>
<pre><code>## [1] 22</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">rt</code></pre>
<pre><code>## # A tibble: 22 x 88
##    user_id status_id created_at          screen_name text  source
##    &lt;chr&gt;   &lt;chr&gt;     &lt;dttm&gt;              &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt; 
##  1 486993… 11222553… 2019-04-27 21:45:02 siddiue_1   It’s… Twitt…
##  2 206063… 11222553… 2019-04-27 21:45:02 SunnyAtThe… &quot;New… Twitt…
##  3 224166… 11222553… 2019-04-27 21:45:03 Ballout_za… &quot;Goi… Twitt…
##  4 372574… 11222553… 2019-04-27 21:45:06 INBulldogR… &quot;We … Faceb…
##  5 419144… 11222553… 2019-04-27 21:45:07 Connected_… &quot;Goi… Twitt…
##  6 419144… 11222554… 2019-04-27 21:45:26 Connected_… Roun… Twitt…
##  7 515705… 11222553… 2019-04-27 21:45:08 lovinglake  &quot;New… Twitt…
##  8 705320… 11222554… 2019-04-27 21:45:12 dainerrr8   New … Twitt…
##  9 110939… 11222554… 2019-04-27 21:45:13 dullncorin… Glad… Twitt…
## 10 304450… 11222554… 2019-04-27 21:45:13 sayragonza… It’s… Twitt…
## # … with 12 more rows, and 82 more variables: display_text_width &lt;dbl&gt;,
## #   reply_to_status_id &lt;chr&gt;, reply_to_user_id &lt;chr&gt;,
## #   reply_to_screen_name &lt;chr&gt;, is_quote &lt;lgl&gt;, is_retweet &lt;lgl&gt;,
## #   favorite_count &lt;int&gt;, retweet_count &lt;int&gt;, hashtags &lt;list&gt;,
## #   symbols &lt;list&gt;, urls_url &lt;list&gt;, urls_t.co &lt;list&gt;,
## #   urls_expanded_url &lt;list&gt;, media_url &lt;list&gt;, media_t.co &lt;list&gt;,
## #   media_expanded_url &lt;list&gt;, media_type &lt;list&gt;, ext_media_url &lt;list&gt;,
## #   ext_media_t.co &lt;list&gt;, ext_media_expanded_url &lt;list&gt;,
## #   ext_media_type &lt;chr&gt;, mentions_user_id &lt;list&gt;,
## #   mentions_screen_name &lt;list&gt;, lang &lt;chr&gt;, quoted_status_id &lt;chr&gt;,
## #   quoted_text &lt;chr&gt;, quoted_created_at &lt;dttm&gt;, quoted_source &lt;chr&gt;,
## #   quoted_favorite_count &lt;int&gt;, quoted_retweet_count &lt;int&gt;,
## #   quoted_user_id &lt;chr&gt;, quoted_screen_name &lt;chr&gt;, quoted_name &lt;chr&gt;,
## #   quoted_followers_count &lt;int&gt;, quoted_friends_count &lt;int&gt;,
## #   quoted_statuses_count &lt;int&gt;, quoted_location &lt;chr&gt;,
## #   quoted_description &lt;chr&gt;, quoted_verified &lt;lgl&gt;,
## #   retweet_status_id &lt;chr&gt;, retweet_text &lt;chr&gt;,
## #   retweet_created_at &lt;dttm&gt;, retweet_source &lt;chr&gt;,
## #   retweet_favorite_count &lt;int&gt;, retweet_retweet_count &lt;int&gt;,
## #   retweet_user_id &lt;chr&gt;, retweet_screen_name &lt;chr&gt;, retweet_name &lt;chr&gt;,
## #   retweet_followers_count &lt;int&gt;, retweet_friends_count &lt;int&gt;,
## #   retweet_statuses_count &lt;int&gt;, retweet_location &lt;chr&gt;,
## #   retweet_description &lt;chr&gt;, retweet_verified &lt;lgl&gt;, place_url &lt;chr&gt;,
## #   place_name &lt;chr&gt;, place_full_name &lt;chr&gt;, place_type &lt;chr&gt;,
## #   country &lt;chr&gt;, country_code &lt;chr&gt;, geo_coords &lt;list&gt;,
## #   coords_coords &lt;list&gt;, bbox_coords &lt;list&gt;, status_url &lt;chr&gt;,
## #   name &lt;chr&gt;, location &lt;chr&gt;, description &lt;chr&gt;, url &lt;chr&gt;,
## #   protected &lt;lgl&gt;, followers_count &lt;int&gt;, friends_count &lt;int&gt;,
## #   listed_count &lt;int&gt;, statuses_count &lt;int&gt;, favourites_count &lt;int&gt;,
## #   account_created_at &lt;dttm&gt;, verified &lt;lgl&gt;, profile_url &lt;chr&gt;,
## #   profile_expanded_url &lt;chr&gt;, account_lang &lt;chr&gt;,
## #   profile_banner_url &lt;chr&gt;, profile_background_url &lt;chr&gt;,
## #   profile_image_url &lt;chr&gt;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## stream tweets for a day (60 secs x 60 mins * 24 hours )</span>
<span class="kw">stream_tweets</span>(
  <span class="st">&quot;abc,nbcnews,cbsnews,nytimes,bbcworld,bbcbreaking,bbcnews,bbcsport&quot;</span>,
  <span class="dt">timeout =</span> <span class="dv">60</span><span class="op">*</span><span class="dv">2</span>,
  <span class="dt">file_name =</span> <span class="st">&quot;tweetsth1.json&quot;</span>,
  <span class="dt">parse =</span> <span class="ot">FALSE</span>
)</code></pre>
<pre><code>## Streaming tweets for 120 seconds...</code></pre>
<pre><code>## Finished streaming tweets!</code></pre>
<pre><code>## streaming data saved as tweetsth1.json</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## read in the data as a tidy tbl data frame</span>
djt1 &lt;-<span class="st"> </span><span class="kw">parse_stream</span>(<span class="st">&quot;tweetsth1.json&quot;</span>)</code></pre>
<pre><code>## opening file input connection.</code></pre>
<pre><code>## 
 Found 500 records...
 Found 1000 records...
 Found 1244 records...
 Imported 1244 records. Simplifying...</code></pre>
<pre><code>## closing file input connection.</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">djt1</code></pre>
<pre><code>## # A tibble: 1,244 x 88
##    user_id status_id created_at          screen_name text  source
##    &lt;chr&gt;   &lt;chr&gt;     &lt;dttm&gt;              &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt; 
##  1 826425… 11222554… 2019-04-27 21:45:28 Elohim_Gad… &quot;Thi… Twitt…
##  2 752949… 11222554… 2019-04-27 21:45:28 hoy2_hoy    She’… Twitt…
##  3 101924… 11222554… 2019-04-27 21:45:28 arrugas12   &quot;Am … Twitt…
##  4 149655… 11222554… 2019-04-27 21:45:28 cat7912     &quot;Hea… Twitt…
##  5 498330… 11222554… 2019-04-27 21:45:28 xa_nico     Cong… Twitt…
##  6 978023… 11222554… 2019-04-27 21:45:28 Dkrennrepc… Espa… Twitt…
##  7 909335… 11222554… 2019-04-27 21:45:28 genoveva_s… &quot;Cru… Twitt…
##  8 404802… 11222554… 2019-04-27 21:45:28 Pritz56Cla… Exac… Twitt…
##  9 111638… 11222554… 2019-04-27 21:45:28 Oscarchars9 I wo… Twitt…
## 10 323348… 11222554… 2019-04-27 21:45:29 wilkin_mol… @Ken… Twitt…
## # … with 1,234 more rows, and 82 more variables: display_text_width &lt;dbl&gt;,
## #   reply_to_status_id &lt;chr&gt;, reply_to_user_id &lt;chr&gt;,
## #   reply_to_screen_name &lt;chr&gt;, is_quote &lt;lgl&gt;, is_retweet &lt;lgl&gt;,
## #   favorite_count &lt;int&gt;, retweet_count &lt;int&gt;, hashtags &lt;list&gt;,
## #   symbols &lt;list&gt;, urls_url &lt;list&gt;, urls_t.co &lt;list&gt;,
## #   urls_expanded_url &lt;list&gt;, media_url &lt;list&gt;, media_t.co &lt;list&gt;,
## #   media_expanded_url &lt;list&gt;, media_type &lt;list&gt;, ext_media_url &lt;list&gt;,
## #   ext_media_t.co &lt;list&gt;, ext_media_expanded_url &lt;list&gt;,
## #   ext_media_type &lt;chr&gt;, mentions_user_id &lt;list&gt;,
## #   mentions_screen_name &lt;list&gt;, lang &lt;chr&gt;, quoted_status_id &lt;chr&gt;,
## #   quoted_text &lt;chr&gt;, quoted_created_at &lt;dttm&gt;, quoted_source &lt;chr&gt;,
## #   quoted_favorite_count &lt;int&gt;, quoted_retweet_count &lt;int&gt;,
## #   quoted_user_id &lt;chr&gt;, quoted_screen_name &lt;chr&gt;, quoted_name &lt;chr&gt;,
## #   quoted_followers_count &lt;int&gt;, quoted_friends_count &lt;int&gt;,
## #   quoted_statuses_count &lt;int&gt;, quoted_location &lt;chr&gt;,
## #   quoted_description &lt;chr&gt;, quoted_verified &lt;lgl&gt;,
## #   retweet_status_id &lt;chr&gt;, retweet_text &lt;chr&gt;,
## #   retweet_created_at &lt;dttm&gt;, retweet_source &lt;chr&gt;,
## #   retweet_favorite_count &lt;int&gt;, retweet_retweet_count &lt;int&gt;,
## #   retweet_user_id &lt;chr&gt;, retweet_screen_name &lt;chr&gt;, retweet_name &lt;chr&gt;,
## #   retweet_followers_count &lt;int&gt;, retweet_friends_count &lt;int&gt;,
## #   retweet_statuses_count &lt;int&gt;, retweet_location &lt;chr&gt;,
## #   retweet_description &lt;chr&gt;, retweet_verified &lt;lgl&gt;, place_url &lt;chr&gt;,
## #   place_name &lt;chr&gt;, place_full_name &lt;chr&gt;, place_type &lt;chr&gt;,
## #   country &lt;chr&gt;, country_code &lt;chr&gt;, geo_coords &lt;list&gt;,
## #   coords_coords &lt;list&gt;, bbox_coords &lt;list&gt;, status_url &lt;chr&gt;,
## #   name &lt;chr&gt;, location &lt;chr&gt;, description &lt;chr&gt;, url &lt;chr&gt;,
## #   protected &lt;lgl&gt;, followers_count &lt;int&gt;, friends_count &lt;int&gt;,
## #   listed_count &lt;int&gt;, statuses_count &lt;int&gt;, favourites_count &lt;int&gt;,
## #   account_created_at &lt;dttm&gt;, verified &lt;lgl&gt;, profile_url &lt;chr&gt;,
## #   profile_expanded_url &lt;chr&gt;, account_lang &lt;chr&gt;,
## #   profile_banner_url &lt;chr&gt;, profile_background_url &lt;chr&gt;,
## #   profile_image_url &lt;chr&gt;</code></pre>
</div>
<div id="other-functions" class="section level4">
<h4><span class="header-section-number">4.4.4.5</span> Other functions</h4>
<p><a href="https://rtweet.info/reference/index.html" class="uri">https://rtweet.info/reference/index.html</a></p>
</div>
</div>
<div id="retweet-networks" class="section level3">
<h3><span class="header-section-number">4.4.5</span> Retweet networks</h3>
<p>Retweet networks: create networks based on datasets</p>
<p>directed: retweet</p>
<p>Similarly, we can get quote networks, replying networks.</p>
<pre class="sourceCode r"><code class="sourceCode r">rt_duke &lt;-<span class="st"> </span><span class="kw">search_tweets</span>(
  <span class="st">&quot;#duke&quot;</span>, <span class="dt">n =</span> <span class="dv">1000</span>
)</code></pre>
<pre><code>## Searching for tweets...</code></pre>
<pre><code>## Finished collecting tweets!</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nrow</span>(rt_duke)</code></pre>
<pre><code>## [1] 902</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(rt_duke)</code></pre>
<pre><code>##  [1] &quot;user_id&quot;                 &quot;status_id&quot;              
##  [3] &quot;created_at&quot;              &quot;screen_name&quot;            
##  [5] &quot;text&quot;                    &quot;source&quot;                 
##  [7] &quot;display_text_width&quot;      &quot;reply_to_status_id&quot;     
##  [9] &quot;reply_to_user_id&quot;        &quot;reply_to_screen_name&quot;   
## [11] &quot;is_quote&quot;                &quot;is_retweet&quot;             
## [13] &quot;favorite_count&quot;          &quot;retweet_count&quot;          
## [15] &quot;hashtags&quot;                &quot;symbols&quot;                
## [17] &quot;urls_url&quot;                &quot;urls_t.co&quot;              
## [19] &quot;urls_expanded_url&quot;       &quot;media_url&quot;              
## [21] &quot;media_t.co&quot;              &quot;media_expanded_url&quot;     
## [23] &quot;media_type&quot;              &quot;ext_media_url&quot;          
## [25] &quot;ext_media_t.co&quot;          &quot;ext_media_expanded_url&quot; 
## [27] &quot;ext_media_type&quot;          &quot;mentions_user_id&quot;       
## [29] &quot;mentions_screen_name&quot;    &quot;lang&quot;                   
## [31] &quot;quoted_status_id&quot;        &quot;quoted_text&quot;            
## [33] &quot;quoted_created_at&quot;       &quot;quoted_source&quot;          
## [35] &quot;quoted_favorite_count&quot;   &quot;quoted_retweet_count&quot;   
## [37] &quot;quoted_user_id&quot;          &quot;quoted_screen_name&quot;     
## [39] &quot;quoted_name&quot;             &quot;quoted_followers_count&quot; 
## [41] &quot;quoted_friends_count&quot;    &quot;quoted_statuses_count&quot;  
## [43] &quot;quoted_location&quot;         &quot;quoted_description&quot;     
## [45] &quot;quoted_verified&quot;         &quot;retweet_status_id&quot;      
## [47] &quot;retweet_text&quot;            &quot;retweet_created_at&quot;     
## [49] &quot;retweet_source&quot;          &quot;retweet_favorite_count&quot; 
## [51] &quot;retweet_retweet_count&quot;   &quot;retweet_user_id&quot;        
## [53] &quot;retweet_screen_name&quot;     &quot;retweet_name&quot;           
## [55] &quot;retweet_followers_count&quot; &quot;retweet_friends_count&quot;  
## [57] &quot;retweet_statuses_count&quot;  &quot;retweet_location&quot;       
## [59] &quot;retweet_description&quot;     &quot;retweet_verified&quot;       
## [61] &quot;place_url&quot;               &quot;place_name&quot;             
## [63] &quot;place_full_name&quot;         &quot;place_type&quot;             
## [65] &quot;country&quot;                 &quot;country_code&quot;           
## [67] &quot;geo_coords&quot;              &quot;coords_coords&quot;          
## [69] &quot;bbox_coords&quot;             &quot;status_url&quot;             
## [71] &quot;name&quot;                    &quot;location&quot;               
## [73] &quot;description&quot;             &quot;url&quot;                    
## [75] &quot;protected&quot;               &quot;followers_count&quot;        
## [77] &quot;friends_count&quot;           &quot;listed_count&quot;           
## [79] &quot;statuses_count&quot;          &quot;favourites_count&quot;       
## [81] &quot;account_created_at&quot;      &quot;verified&quot;               
## [83] &quot;profile_url&quot;             &quot;profile_expanded_url&quot;   
## [85] &quot;account_lang&quot;            &quot;profile_banner_url&quot;     
## [87] &quot;profile_background_url&quot;  &quot;profile_image_url&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">netdf=rt_duke<span class="op">%&gt;%</span>dplyr<span class="op">::</span><span class="kw">select</span>(.,screen_name,retweet_screen_name,is_retweet)
netdfr=netdf<span class="op">%&gt;%</span><span class="kw">filter</span>(is_retweet)<span class="op">%&gt;%</span><span class="kw">select</span>(<span class="op">-</span>is_retweet)
netdfp=netdf<span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="op">!</span>is_retweet)<span class="op">%&gt;%</span><span class="kw">pull</span>(screen_name)
igra_duke=<span class="kw">graph_from_data_frame</span>(netdfr)<span class="co">#+netdfp</span>
<span class="kw">E</span>(igra_duke)<span class="op">$</span>weight=<span class="kw">rep</span>(<span class="dv">1</span>,<span class="kw">ecount</span>(igra_duke))
igra_duke_s &lt;-<span class="st"> </span>igraph<span class="op">::</span><span class="kw">simplify</span>( igra_duke, <span class="dt">remove.multiple =</span> T, <span class="dt">remove.loops =</span> F, 
                 <span class="dt">edge.attr.comb=</span><span class="kw">c</span>(<span class="dt">weight=</span><span class="st">&quot;sum&quot;</span>))
igra_duke_s</code></pre>
<pre><code>## IGRAPH 495b8da DNW- 582 512 -- 
## + attr: name (v/c), weight (e/n)
## + edges from 495b8da (vertex names):
##  [1] SirKevinJ_     -&gt;rhj_24324      TanyaAn83350700-&gt;ravenec       
##  [3] kiasuchick     -&gt;JohnFischesser Dukeu1         -&gt;rhj_24324     
##  [5] dukefan0101    -&gt;rhj_24324      edgysam        -&gt;edgysam       
##  [7] misiloma       -&gt;CGrotjohn      gnidazfiled    -&gt;wcelsberry    
##  [9] RANBOY_D_Go    -&gt;rhj_24324      AlanaFi75297926-&gt;W110dat       
## [11] breedarreime   -&gt;unsoldado05    Godswarrior1993-&gt;PatChiesa     
## [13] KimWendel      -&gt;PatChiesa      potato_wizard44-&gt;rhj_24324     
## [15] EarlClausen_   -&gt;rhj_24324      Dwomack_8      -&gt;rhj_24324     
## + ... omitted several edges</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(igra_duke_s,<span class="dt">vertex.color=</span><span class="st">&quot;gold&quot;</span>, <span class="dt">vertex.size=</span><span class="kw">log</span>(igraph<span class="op">::</span><span class="kw">degree</span>(igra_duke_s))<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">1</span>, 
     <span class="dt">vertex.frame.color=</span><span class="st">&quot;gray&quot;</span>, <span class="dt">vertex.label.color=</span><span class="st">&quot;black&quot;</span>, 
     <span class="dt">vertex.label.cex=</span><span class="kw">log</span>(igraph<span class="op">::</span><span class="kw">degree</span>(igra_duke_s))<span class="op">*</span><span class="fl">0.2+0.1</span>, <span class="dt">vertex.label.dist=</span><span class="dv">2</span>, <span class="dt">edge.curved=</span><span class="fl">0.5</span>,<span class="dt">edge.arrow.size=</span>.<span class="dv">2</span>)</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-130-1.png" width="672" /></p>
</div>
<div id="friendship-networks" class="section level3">
<h3><span class="header-section-number">4.4.6</span> Friendship networks</h3>
<div id="get_friends" class="section level4">
<h4><span class="header-section-number">4.4.6.1</span> <code>get_friends()</code></h4>
<p>Friendship network of NYC political science</p>
<p>directed: following</p>
<p><code>get_friends()</code>: Get user IDs of accounts followed by target user(s).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">##maximum ids: 100</span>
user.seed=<span class="st">&quot;drewconway&quot;</span>
user.following=<span class="kw">get_friends</span>(user.seed,<span class="dt">n=</span><span class="dv">500</span>,<span class="dt">retryonratelimit =</span> <span class="ot">TRUE</span>)
<span class="kw">nrow</span>(user.following)</code></pre>
<pre><code>## [1] 290</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">user.following<span class="op">%&gt;%</span><span class="kw">head</span>(<span class="dv">5</span>)</code></pre>
<pre><code>## # A tibble: 5 x 2
##   user       user_id           
##   &lt;chr&gt;      &lt;chr&gt;             
## 1 drewconway 846137120209190912
## 2 drewconway 6156562           
## 3 drewconway 36133587          
## 4 drewconway 5850692           
## 5 drewconway 132496568</code></pre>
</div>
<div id="filter-on-the-following-user-list" class="section level4">
<h4><span class="header-section-number">4.4.6.2</span> filter on the following user list</h4>
<pre class="sourceCode r"><code class="sourceCode r">info.following=<span class="kw">lookup_users</span>(user.following<span class="op">$</span>user_id)
info.following</code></pre>
<pre><code>## # A tibble: 290 x 88
##    user_id status_id created_at          screen_name text  source
##    &lt;chr&gt;   &lt;chr&gt;     &lt;dttm&gt;              &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt; 
##  1 846137… 11222205… 2019-04-27 19:26:55 dog_feelin… WE A… Twitt…
##  2 6156562 11206873… 2019-04-23 13:54:13 aewo        We a… Twitt…
##  3 361335… 11222387… 2019-04-27 20:38:56 bearloga    @tar… Tweet…
##  4 5850692 11222044… 2019-04-27 18:22:46 Aaroth      @mir… Twitt…
##  5 132496… 11222486… 2019-04-27 21:18:27 NewYorkSta… &quot;Dev… Twitt…
##  6 152765… 11218464… 2019-04-26 18:40:19 drewharwell How … Tweet…
##  7 160392… 11222517… 2019-04-27 21:30:42 pklinkne    Trum… Twitt…
##  8 235070… 11221966… 2019-04-27 17:51:56 stasavage   Cong… Twitt…
##  9 881321… 11222415… 2019-04-27 20:50:20 BackAftaTh… &quot;@ca… Twitt…
## 10 269349… 11222463… 2019-04-27 21:09:13 TheFFBalle… Comi… Twitt…
## # … with 280 more rows, and 82 more variables: display_text_width &lt;int&gt;,
## #   reply_to_status_id &lt;chr&gt;, reply_to_user_id &lt;chr&gt;,
## #   reply_to_screen_name &lt;chr&gt;, is_quote &lt;lgl&gt;, is_retweet &lt;lgl&gt;,
## #   favorite_count &lt;int&gt;, retweet_count &lt;int&gt;, hashtags &lt;list&gt;,
## #   symbols &lt;list&gt;, urls_url &lt;list&gt;, urls_t.co &lt;list&gt;,
## #   urls_expanded_url &lt;list&gt;, media_url &lt;list&gt;, media_t.co &lt;list&gt;,
## #   media_expanded_url &lt;list&gt;, media_type &lt;list&gt;, ext_media_url &lt;list&gt;,
## #   ext_media_t.co &lt;list&gt;, ext_media_expanded_url &lt;list&gt;,
## #   ext_media_type &lt;chr&gt;, mentions_user_id &lt;list&gt;,
## #   mentions_screen_name &lt;list&gt;, lang &lt;chr&gt;, quoted_status_id &lt;chr&gt;,
## #   quoted_text &lt;chr&gt;, quoted_created_at &lt;dttm&gt;, quoted_source &lt;chr&gt;,
## #   quoted_favorite_count &lt;int&gt;, quoted_retweet_count &lt;int&gt;,
## #   quoted_user_id &lt;chr&gt;, quoted_screen_name &lt;chr&gt;, quoted_name &lt;chr&gt;,
## #   quoted_followers_count &lt;int&gt;, quoted_friends_count &lt;int&gt;,
## #   quoted_statuses_count &lt;int&gt;, quoted_location &lt;chr&gt;,
## #   quoted_description &lt;chr&gt;, quoted_verified &lt;lgl&gt;,
## #   retweet_status_id &lt;chr&gt;, retweet_text &lt;chr&gt;,
## #   retweet_created_at &lt;dttm&gt;, retweet_source &lt;chr&gt;,
## #   retweet_favorite_count &lt;int&gt;, retweet_retweet_count &lt;int&gt;,
## #   retweet_user_id &lt;chr&gt;, retweet_screen_name &lt;chr&gt;, retweet_name &lt;chr&gt;,
## #   retweet_followers_count &lt;int&gt;, retweet_friends_count &lt;int&gt;,
## #   retweet_statuses_count &lt;int&gt;, retweet_location &lt;chr&gt;,
## #   retweet_description &lt;chr&gt;, retweet_verified &lt;lgl&gt;, place_url &lt;chr&gt;,
## #   place_name &lt;chr&gt;, place_full_name &lt;chr&gt;, place_type &lt;chr&gt;,
## #   country &lt;chr&gt;, country_code &lt;chr&gt;, geo_coords &lt;list&gt;,
## #   coords_coords &lt;list&gt;, bbox_coords &lt;list&gt;, status_url &lt;chr&gt;,
## #   name &lt;chr&gt;, location &lt;chr&gt;, description &lt;chr&gt;, url &lt;chr&gt;,
## #   protected &lt;lgl&gt;, followers_count &lt;int&gt;, friends_count &lt;int&gt;,
## #   listed_count &lt;int&gt;, statuses_count &lt;int&gt;, favourites_count &lt;int&gt;,
## #   account_created_at &lt;dttm&gt;, verified &lt;lgl&gt;, profile_url &lt;chr&gt;,
## #   profile_expanded_url &lt;chr&gt;, account_lang &lt;chr&gt;,
## #   profile_banner_url &lt;chr&gt;, profile_background_url &lt;chr&gt;,
## #   profile_image_url &lt;chr&gt;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(info.following)</code></pre>
<pre><code>##  [1] &quot;user_id&quot;                 &quot;status_id&quot;              
##  [3] &quot;created_at&quot;              &quot;screen_name&quot;            
##  [5] &quot;text&quot;                    &quot;source&quot;                 
##  [7] &quot;display_text_width&quot;      &quot;reply_to_status_id&quot;     
##  [9] &quot;reply_to_user_id&quot;        &quot;reply_to_screen_name&quot;   
## [11] &quot;is_quote&quot;                &quot;is_retweet&quot;             
## [13] &quot;favorite_count&quot;          &quot;retweet_count&quot;          
## [15] &quot;hashtags&quot;                &quot;symbols&quot;                
## [17] &quot;urls_url&quot;                &quot;urls_t.co&quot;              
## [19] &quot;urls_expanded_url&quot;       &quot;media_url&quot;              
## [21] &quot;media_t.co&quot;              &quot;media_expanded_url&quot;     
## [23] &quot;media_type&quot;              &quot;ext_media_url&quot;          
## [25] &quot;ext_media_t.co&quot;          &quot;ext_media_expanded_url&quot; 
## [27] &quot;ext_media_type&quot;          &quot;mentions_user_id&quot;       
## [29] &quot;mentions_screen_name&quot;    &quot;lang&quot;                   
## [31] &quot;quoted_status_id&quot;        &quot;quoted_text&quot;            
## [33] &quot;quoted_created_at&quot;       &quot;quoted_source&quot;          
## [35] &quot;quoted_favorite_count&quot;   &quot;quoted_retweet_count&quot;   
## [37] &quot;quoted_user_id&quot;          &quot;quoted_screen_name&quot;     
## [39] &quot;quoted_name&quot;             &quot;quoted_followers_count&quot; 
## [41] &quot;quoted_friends_count&quot;    &quot;quoted_statuses_count&quot;  
## [43] &quot;quoted_location&quot;         &quot;quoted_description&quot;     
## [45] &quot;quoted_verified&quot;         &quot;retweet_status_id&quot;      
## [47] &quot;retweet_text&quot;            &quot;retweet_created_at&quot;     
## [49] &quot;retweet_source&quot;          &quot;retweet_favorite_count&quot; 
## [51] &quot;retweet_retweet_count&quot;   &quot;retweet_user_id&quot;        
## [53] &quot;retweet_screen_name&quot;     &quot;retweet_name&quot;           
## [55] &quot;retweet_followers_count&quot; &quot;retweet_friends_count&quot;  
## [57] &quot;retweet_statuses_count&quot;  &quot;retweet_location&quot;       
## [59] &quot;retweet_description&quot;     &quot;retweet_verified&quot;       
## [61] &quot;place_url&quot;               &quot;place_name&quot;             
## [63] &quot;place_full_name&quot;         &quot;place_type&quot;             
## [65] &quot;country&quot;                 &quot;country_code&quot;           
## [67] &quot;geo_coords&quot;              &quot;coords_coords&quot;          
## [69] &quot;bbox_coords&quot;             &quot;status_url&quot;             
## [71] &quot;name&quot;                    &quot;location&quot;               
## [73] &quot;description&quot;             &quot;url&quot;                    
## [75] &quot;protected&quot;               &quot;followers_count&quot;        
## [77] &quot;friends_count&quot;           &quot;listed_count&quot;           
## [79] &quot;statuses_count&quot;          &quot;favourites_count&quot;       
## [81] &quot;account_created_at&quot;      &quot;verified&quot;               
## [83] &quot;profile_url&quot;             &quot;profile_expanded_url&quot;   
## [85] &quot;account_lang&quot;            &quot;profile_banner_url&quot;     
## [87] &quot;profile_background_url&quot;  &quot;profile_image_url&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">##choose the filtering criterion: description, verified (blue check mark), location</span>
info.following<span class="op">%&gt;%</span><span class="kw">select</span>(geo_coords,country,country_code,location)<span class="op">%&gt;%</span><span class="kw">lat_lng</span>()</code></pre>
<pre><code>## # A tibble: 290 x 8
##    geo_coords country country_code location   lat   lng coords_coords
##    &lt;list&gt;     &lt;chr&gt;   &lt;chr&gt;        &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;
##  1 &lt;dbl [2]&gt;  &lt;NA&gt;    &lt;NA&gt;         &quot;&quot;          NA    NA            NA
##  2 &lt;dbl [2]&gt;  &lt;NA&gt;    &lt;NA&gt;         NYC         NA    NA            NA
##  3 &lt;dbl [2]&gt;  &lt;NA&gt;    &lt;NA&gt;         Pittsbu…    NA    NA            NA
##  4 &lt;dbl [2]&gt;  &lt;NA&gt;    &lt;NA&gt;         Philade…    NA    NA            NA
##  5 &lt;dbl [2]&gt;  &lt;NA&gt;    &lt;NA&gt;         New York    NA    NA            NA
##  6 &lt;dbl [2]&gt;  &lt;NA&gt;    &lt;NA&gt;         D.C.        NA    NA            NA
##  7 &lt;dbl [2]&gt;  &lt;NA&gt;    &lt;NA&gt;         Hamilto…    NA    NA            NA
##  8 &lt;dbl [2]&gt;  &lt;NA&gt;    &lt;NA&gt;         New Yor…    NA    NA            NA
##  9 &lt;dbl [2]&gt;  &lt;NA&gt;    &lt;NA&gt;         &quot;&quot;          NA    NA            NA
## 10 &lt;dbl [2]&gt;  &lt;NA&gt;    &lt;NA&gt;         Phoenix…    NA    NA            NA
## # … with 280 more rows, and 1 more variable: bbox_coords &lt;dbl&gt;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## filter based on description</span>
candidates=info.following<span class="op">%&gt;%</span><span class="kw">filter</span>(description<span class="op">%&gt;%</span>
<span class="st">                          </span><span class="kw">str_detect</span>(<span class="st">&quot;nyu|new york university&quot;</span>),
                        description<span class="op">%&gt;%</span>
<span class="st">                          </span><span class="kw">str_detect</span>(<span class="st">&quot;poli(tics|tical|sci|cy)&quot;</span>))<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(user_id,screen_name,name,friends_count,description)
candidates<span class="op">%&gt;%</span><span class="kw">head</span>(<span class="dv">5</span>)</code></pre>
<pre><code>## # A tibble: 1 x 5
##   user_id  screen_name name     friends_count description                  
##   &lt;chr&gt;    &lt;chr&gt;       &lt;chr&gt;            &lt;int&gt; &lt;chr&gt;                        
## 1 8448612… zeitzoff    Thomas …          2667 Associate professor @AU_SPA.…</code></pre>
</div>
<div id="request-rate-limit" class="section level4">
<h4><span class="header-section-number">4.4.6.3</span> request rate limit</h4>
<p><code>rate_limit</code></p>
<p><a href="https://developer.twitter.com/en/docs/developer-utilities/rate-limit-status/api-reference/get-application-rate_limit_status" class="uri">https://developer.twitter.com/en/docs/developer-utilities/rate-limit-status/api-reference/get-application-rate_limit_status</a></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rate_limit</span>()<span class="op">%&gt;%</span><span class="kw">head</span>()</code></pre>
<pre><code>## # A tibble: 6 x 7
##   query limit remaining reset reset_at            timestamp           app  
##   &lt;chr&gt; &lt;int&gt;     &lt;int&gt; &lt;tim&gt; &lt;dttm&gt;              &lt;dttm&gt;              &lt;chr&gt;
## 1 list…    15        15 15.0… 2019-04-27 18:02:47 2019-04-27 17:47:47 Test…
## 2 list…    75        75 15.0… 2019-04-27 18:02:47 2019-04-27 17:47:47 Test…
## 3 list…    15        15 15.0… 2019-04-27 18:02:47 2019-04-27 17:47:47 Test…
## 4 list…   900       900 15.0… 2019-04-27 18:02:47 2019-04-27 17:47:47 Test…
## 5 list…    15        15 15.0… 2019-04-27 18:02:47 2019-04-27 17:47:47 Test…
## 6 list…    75        75 15.0… 2019-04-27 18:02:47 2019-04-27 17:47:47 Test…</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rate_limit</span>(<span class="st">&quot;get_friends&quot;</span>)</code></pre>
<pre><code>## # A tibble: 1 x 7
##   query limit remaining reset reset_at            timestamp           app  
##   &lt;chr&gt; &lt;int&gt;     &lt;int&gt; &lt;tim&gt; &lt;dttm&gt;              &lt;dttm&gt;              &lt;chr&gt;
## 1 frie…    15        14 14.9… 2019-04-27 18:02:45 2019-04-27 17:47:47 Test…</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">get_friends</span>(<span class="kw">c</span>(<span class="st">&quot;drewconway&quot;</span>,<span class="st">&quot;BarackObama&quot;</span>))</code></pre>
<pre><code>## 1 friend networks collected!</code></pre>
<pre><code>## 2 friend networks collected!</code></pre>
<pre><code>## # A tibble: 5,290 x 2
##    user       user_id           
##    &lt;chr&gt;      &lt;chr&gt;             
##  1 drewconway 846137120209190912
##  2 drewconway 6156562           
##  3 drewconway 36133587          
##  4 drewconway 5850692           
##  5 drewconway 132496568         
##  6 drewconway 15276573          
##  7 drewconway 16039252          
##  8 drewconway 2350709449        
##  9 drewconway 881321968301223937
## 10 drewconway 2693496433        
## # … with 5,280 more rows</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rate_limit</span>(<span class="st">&quot;get_friends&quot;</span>) <span class="co"># 15 every 15 min</span></code></pre>
<pre><code>## # A tibble: 1 x 7
##   query limit remaining reset reset_at            timestamp           app  
##   &lt;chr&gt; &lt;int&gt;     &lt;int&gt; &lt;tim&gt; &lt;dttm&gt;              &lt;dttm&gt;              &lt;chr&gt;
## 1 frie…    15        12 14.9… 2019-04-27 18:02:45 2019-04-27 17:47:48 Test…</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rate_limit</span>(<span class="st">&quot;lookup_users&quot;</span>) <span class="co"># 900 every 15 min</span></code></pre>
<pre><code>## # A tibble: 1 x 7
##   query limit remaining reset reset_at            timestamp           app  
##   &lt;chr&gt; &lt;int&gt;     &lt;int&gt; &lt;tim&gt; &lt;dttm&gt;              &lt;dttm&gt;              &lt;chr&gt;
## 1 user…   900       897 14.9… 2019-04-27 18:02:46 2019-04-27 17:47:48 Test…</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">limit.fri=<span class="kw">rate_limit</span>(<span class="st">&quot;get_friends&quot;</span>)
  <span class="cf">if</span> (limit.fri<span class="op">$</span>remaining<span class="op">==</span><span class="dv">0</span>){
    <span class="kw">Sys.sleep</span>(<span class="dv">60</span><span class="op">*</span><span class="kw">as.numeric</span>(limit.fri<span class="op">$</span>reset))}</code></pre>
</div>
<div id="friendship-network" class="section level4">
<h4><span class="header-section-number">4.4.6.4</span> Friendship network</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># seed user</span>
user.seed=<span class="st"> </span><span class="dv">20916144</span> <span class="co">#&quot;cdsamii&quot;</span>
user.following=<span class="kw">get_friends</span>(user.seed,<span class="dt">n=</span><span class="dv">15</span>,<span class="dt">retryonratelimit =</span> <span class="ot">TRUE</span>)
userid=<span class="kw">c</span>(user.seed,user.following<span class="op">$</span>user_id)
info.following=<span class="kw">lookup_users</span>(userid)
user.df=info.following<span class="op">%&gt;%</span><span class="kw">filter</span>(description<span class="op">%&gt;%</span>
<span class="st">                          </span><span class="kw">str_detect</span>(<span class="kw">regex</span>(<span class="st">&quot;nyu|new york university&quot;</span>,<span class="dt">ignore_case =</span> T)),
                        description<span class="op">%&gt;%</span>
<span class="st">                          </span><span class="kw">str_detect</span>(<span class="kw">regex</span>(<span class="st">&quot;poli(tics|tical|sci|cy)&quot;</span>,<span class="dt">ignore_case =</span> T))
                        )<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(user_id,screen_name,name,friends_count,description)
acc.id=user.df<span class="op">$</span>user_id <span class="co"># qualified id</span>
nyc.id=user.seed <span class="co"># already scrapped the friends</span>
can.id=acc.id[<span class="op">!</span>acc.id<span class="op">%in%</span>nyc.id] <span class="co"># to be scrapped</span>
rej.id=userid[<span class="op">!</span>info.following<span class="op">$</span>user_id<span class="op">%in%</span>acc.id] <span class="co"># non-qualified</span>
edge.list=user.following<span class="op">%&gt;%</span><span class="kw">filter</span>(user_id<span class="op">%in%</span>acc.id) <span class="co"># netowork</span>
info.id=userid <span class="co"># already request user info</span>
<span class="cf">while</span>((<span class="kw">length</span>(nyc.id)<span class="op">&lt;</span><span class="dv">100</span>)){
  <span class="co"># pick the first user in the acc.id</span>
user.following=<span class="kw">get_friends</span>(can.id,<span class="dt">n=</span><span class="dv">1000</span>,<span class="dt">retryonratelimit =</span> <span class="ot">TRUE</span>)
userid=user.following<span class="op">$</span>user_id
useridx=userid[<span class="op">!</span>userid<span class="op">%in%</span>info.id] <span class="co"># new userid</span>
info.following=<span class="kw">lookup_users</span>(useridx)
user.dfx=info.following<span class="op">%&gt;%</span><span class="kw">filter</span>(description<span class="op">%&gt;%</span>
<span class="st">                          </span><span class="kw">str_detect</span>(<span class="kw">regex</span>(<span class="st">&quot;nyu|new york university&quot;</span>,<span class="dt">ignore_case =</span> T)),
                        description<span class="op">%&gt;%</span>
<span class="st">                          </span><span class="kw">str_detect</span>(<span class="kw">regex</span>(<span class="st">&quot;poli(tics|tical|sci|cy)&quot;</span>,<span class="dt">ignore_case =</span> T))
                        )<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(user_id,screen_name,name,friends_count,description)
nyc.id=<span class="kw">c</span>(nyc.id,can.id)<span class="op">%&gt;%</span><span class="kw">unique</span>() <span class="co">#already scrapped and in the list</span>
<span class="cf">if</span>(<span class="kw">nrow</span>(user.dfx)<span class="op">==</span><span class="dv">0</span>){<span class="cf">break</span>}
user.df=<span class="kw">rbind</span>(user.df,user.dfx) <span class="co">#merge user info df</span>
can.id=user.dfx<span class="op">$</span>user_id <span class="co">#to be scrapped</span>
rej.idx=useridx[<span class="op">!</span>useridx<span class="op">%in%</span>can.id] <span class="co">#not qualified</span>
rej.id=<span class="kw">c</span>(rej.id,rej.idx)<span class="op">%&gt;%</span><span class="kw">unique</span>()
acc.id=<span class="kw">c</span>(acc.id,can.id)<span class="op">%&gt;%</span><span class="kw">unique</span>()
info.id=<span class="kw">c</span>(info.id,useridx)<span class="op">%&gt;%</span><span class="kw">unique</span>()
edge.listx=user.following<span class="op">%&gt;%</span><span class="kw">filter</span>(user_id<span class="op">%in%</span>acc.id) <span class="co">#add edgelist</span>
edge.list=<span class="kw">rbind</span>(edge.list,edge.listx)
}</code></pre>
</div>
<div id="network-visualization" class="section level4">
<h4><span class="header-section-number">4.4.6.5</span> Network Visualization</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">&quot;images/friendship.rdata&quot;</span>)
edge.list<span class="op">%&gt;%</span><span class="kw">head</span>(<span class="dv">5</span>)</code></pre>
<pre><code>## # A tibble: 5 x 2
##   user     user_id            
##   &lt;chr&gt;    &lt;chr&gt;              
## 1 20916144 99679924           
## 2 99679924 31049199           
## 3 99679924 2961443543         
## 4 99679924 288295699          
## 5 99679924 1023012089416298496</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">user.df<span class="op">%&gt;%</span><span class="kw">head</span>(<span class="dv">5</span>)</code></pre>
<pre><code>## # A tibble: 5 x 5
##   user_id  screen_name name      friends_count description                 
##   &lt;chr&gt;    &lt;chr&gt;       &lt;chr&gt;             &lt;int&gt; &lt;chr&gt;                       
## 1 20916144 cdsamii     Cyrus Sa…           543 I study methods to inform p…
## 2 99679924 YeWang1576  Ye Wang             454 Political Science PhD stude…
## 3 31049199 DrewDim     Drew Dim…          1758 Social Scientific Methodolo…
## 4 2961443… yxqsophie   Sophie X…            82 Ph.D. student at NYU Politi…
## 5 2882956… _avecchiato Alessand…           321 Ph.D. candidate at @NYUPoli…</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(igraph)
net=<span class="kw">graph_from_data_frame</span>(edge.list)
netsim=igraph<span class="op">::</span><span class="kw">simplify</span>(net, <span class="dt">remove.multiple =</span> T, <span class="dt">remove.loops =</span> F)
<span class="kw">V</span>(netsim)<span class="op">$</span>id=<span class="kw">V</span>(netsim)<span class="op">$</span>name

user.df=user.df <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">unique</span>()<span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">arrange</span>(<span class="kw">match</span>(user_id, <span class="kw">V</span>(netsim)<span class="op">$</span>id))
user.name=user.df<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">pull</span>(name)
<span class="kw">V</span>(netsim)<span class="op">$</span>name=user.name
<span class="kw">V</span>(netsim)<span class="op">$</span>degree=user.df<span class="op">$</span>friends_count
<span class="kw">set.seed</span>(<span class="dv">123</span>)
<span class="kw">plot</span>(netsim,<span class="dt">vertex.name=</span><span class="kw">V</span>(netsim)<span class="op">$</span>user.name,<span class="dt">vertex.color=</span><span class="st">&quot;gold&quot;</span>, <span class="dt">vertex.size=</span><span class="kw">log</span>(<span class="kw">V</span>(netsim)<span class="op">$</span>degree)<span class="op">*</span>.<span class="dv">8</span><span class="fl">+0.01</span>, 
     <span class="dt">vertex.frame.color=</span><span class="st">&quot;gray&quot;</span>, <span class="dt">vertex.label.color=</span><span class="st">&quot;black&quot;</span>, 
     <span class="dt">vertex.label.cex=</span><span class="fl">0.5</span>, <span class="dt">vertex.label.dist=</span><span class="dv">2</span>, <span class="dt">edge.curved=</span><span class="fl">0.5</span>,<span class="dt">edge.arrow.size=</span>.<span class="dv">2</span>,<span class="dt">vertex.label.cex=</span>.<span class="dv">5</span>,<span class="dt">vertex.label=</span><span class="ot">NA</span>)</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-136-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="other-apis" class="section level2">
<h2><span class="header-section-number">4.5</span> Other APIs</h2>
<ul>
<li>[<code>Rfacebook</code>])(<a href="https://cran.r-project.org/web/packages/Rfacebook/Rfacebook.pdf" class="uri">https://cran.r-project.org/web/packages/Rfacebook/Rfacebook.pdf</a>) (facebook)</li>
<li><p><a href="https://cran.r-project.org/web/packages/RedditExtractoR/RedditExtractoR.pdf"><code>RedditExtractoR</code></a> (reddit)</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/imdbapi/imdbapi.pdf"><code>imdbapi</code></a> (IMDB)</p></li>
<li><p><a href="https://github.com/hrbrmstr/omdbapi"><code>omdbapi</code></a>(The Open Movie Database)</p></li>
</ul>
</div>
<div id="api-request-directly-from-r" class="section level2">
<h2><span class="header-section-number">4.6</span> API request directly from R</h2>
<div id="introduction-3" class="section level3">
<h3><span class="header-section-number">4.6.1</span> Introduction</h3>
<p>The movie database API <a href="https://www.themoviedb.org/" class="uri">https://www.themoviedb.org/</a></p>
<ul>
<li>Signup and request for an API key <a href="https://developers.themoviedb.org/3/getting-started/introduction" class="uri">https://developers.themoviedb.org/3/getting-started/introduction</a></li>
<li>Write functions to make query:
<ul>
<li>Create a query</li>
<li>From JSON file to dataframe</li>
</ul></li>
<li>Build your own network based on these functions</li>
</ul>
</div>
<div id="preparation-4" class="section level3">
<h3><span class="header-section-number">4.6.2</span> preparation</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages(&quot;rjson&quot;)</span>
<span class="kw">library</span>(rjson)
<span class="co">#install.packages(&quot;jsonlite&quot;)</span>
<span class="kw">library</span>(jsonlite)</code></pre>
</div>
<div id="search-people-id" class="section level3">
<h3><span class="header-section-number">4.6.3</span> search people id</h3>
<p>Search people based on the name:
<a href="https://developers.themoviedb.org/3/search/search-people" class="uri">https://developers.themoviedb.org/3/search/search-people</a></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">### get actor/director id based on name</span>
get_search_people =<span class="st"> </span><span class="cf">function</span>(people,<span class="dt">api=</span><span class="st">&quot;YOUR_API_ACCOUNT&quot;</span>){
  
  search =<span class="st"> </span><span class="kw">URLencode</span>(people, <span class="dt">reserved =</span> <span class="ot">TRUE</span>) 
  
  people_url =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;https://api.themoviedb.org/3/search/person?api_key=&quot;</span>,api,<span class="st">&quot;&amp;language=en-US&amp;query=&quot;</span>,
                      search,<span class="st">&quot;&amp;include_adult=false&quot;</span>)
  people_json =<span class="st"> </span>jsonlite<span class="op">::</span><span class="kw">fromJSON</span>(<span class="kw">paste</span>(<span class="kw">readLines</span>(people_url), <span class="dt">collapse=</span><span class="st">&quot;&quot;</span>))
  
  total_page =<span class="st"> </span>people_json<span class="op">$</span>total_pages
  <span class="cf">if</span> (total_page <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>){
    people_id_df =<span class="st"> </span><span class="kw">data.frame</span>()
    n =<span class="st"> </span><span class="kw">min</span>(<span class="dv">5</span>, total_page)
    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
      url =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;https://api.themoviedb.org/3/search/person?api_key=&quot;</span>,api,<span class="st">&quot;&amp;language=en-US&amp;query=&quot;</span>,
                   search,<span class="st">&quot;&amp;page=&quot;</span>,j,<span class="st">&quot;&amp;include_adult=false&quot;</span>)
      json =<span class="st"> </span>jsonlite<span class="op">::</span><span class="kw">fromJSON</span>(<span class="kw">paste</span>(<span class="kw">readLines</span>(people_url), <span class="dt">collapse=</span><span class="st">&quot;&quot;</span>))
      temp =<span class="st"> </span>json<span class="op">$</span>results <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(id, name)
      people_id_df =<span class="st"> </span><span class="kw">rbind</span>(people_id_df, temp)
    }
  } <span class="cf">else</span> {
    people_id_df =<span class="st"> </span>people_json<span class="op">$</span>results <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(id, name)
  }
  
  <span class="kw">return</span>(people_id_df) <span class="co"># this dataframe only contains name and people id</span>
  
}
actress=<span class="st">&quot;Julianne Moore&quot;</span> <span class="co"># She comes from NC</span>
<span class="kw">get_search_people</span>(actress)
people=actress</code></pre>
</div>
<div id="search-movies-based-on-people-id" class="section level3">
<h3><span class="header-section-number">4.6.4</span> search movies based on people id</h3>
<p>Search the movies of one person based on id:<a href="https://developers.themoviedb.org/3/people/get-person-movie-credits" class="uri">https://developers.themoviedb.org/3/people/get-person-movie-credits</a></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># get movie details of one person with the person id</span>
get_people_movie =<span class="st"> </span><span class="cf">function</span>(id,<span class="dt">api=</span><span class="st">&quot;YOUR_API_ACCOUNT&quot;</span>){
  
  url =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;https://api.themoviedb.org/3/person/&quot;</span>,id,<span class="st">&quot;/movie_credits?api_key=&quot;</span>,api,<span class="st">&quot;&amp;language=en-US&quot;</span>)
  people_movie_json =<span class="st"> </span>jsonlite<span class="op">::</span><span class="kw">fromJSON</span>(<span class="kw">paste</span>(<span class="kw">readLines</span>(url), <span class="dt">collapse=</span><span class="st">&quot;&quot;</span>))
  people_movie_df =<span class="st"> </span>people_movie_json<span class="op">$</span>cast <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(character, poster_path, id, vote_average, original_language,
                                                                          title, popularity, overview, release_date)
  base_url =<span class="st"> &quot;http://image.tmdb.org/t/p/w500&quot;</span> 
  people_movie_df =<span class="st"> </span>people_movie_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">poster_path =</span> <span class="kw">paste0</span>(base_url, poster_path))
  
  <span class="kw">return</span>(people_movie_df)
  
}
id=<span class="dv">1231</span> <span class="co"># got from the previous function `get_search_people`</span>
<span class="kw">get_people_movie</span>(id)</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ergm-statnet-package.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="advanced-network-visualization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
